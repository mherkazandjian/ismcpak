

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>mesh &mdash; ismcpak 0.0.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="ismcpak 0.0.0 documentation" href="../index.html" />
    <link rel="up" title="Module code" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">ismcpak 0.0.0 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for mesh</h1><div class="highlight"><pre>
<span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">import</span> <span class="nn">pylab</span>

<span class="kn">from</span> <span class="nn">ismUtils</span> <span class="kn">import</span> <span class="n">getSlabThicknessFromAv</span>
<span class="kn">from</span> <span class="nn">mylib.utils.misc</span> <span class="kn">import</span> <span class="n">fetchNestedDtypeValue</span>

<div class="viewcode-block" id="mesh"><a class="viewcode-back" href="../index.html#mesh.mesh">[docs]</a><span class="k">class</span> <span class="nc">mesh</span><span class="p">(</span> <span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;This class read a PDR mesh and returns an object containing all the data of that mesh.</span>
<span class="sd">        </span>
<span class="sd">        :param string fileName: path of the binary file holding the data of the mesh. this is assigned to :data:`self.fileName &lt;fName&gt;`</span>
<span class="sd">        :param chemicalNetwork chemNet: the chemical network object instance. this is assigned to :data:`self.chemNet &lt;chemNet&gt;`</span>
<span class="sd">        :param numpy.float64 metallicity: the metallicity to be used in the computations for this mesh.  this is assigned to :data:`self.metallicity &lt;metallicity&gt;`</span>
<span class="sd">        :returns: mesh object</span>

<span class="sd">        .. code-block:: python</span>
<span class="sd">        </span>
<span class="sd">            m = mesh(path)</span>
<span class="sd">            m.data[&#39;hdr&#39;]  # dtype defined in self.headerFormat()</span>
<span class="sd">            m.data[&#39;hdr&#39;][&#39;version&#39;]</span>
<span class="sd">            m.data[&#39;hdr&#39;][&#39;G0&#39;]</span>
<span class="sd">            m.data[&#39;hdr&#39;][&#39;nGas&#39;]</span>
<span class="sd">            m.data[&#39;hdr&#39;][&#39;gammaMech&#39;]  </span>
<span class="sd">            m.data[&#39;hdr&#39;][&#39;nSteps&#39;]</span>
<span class="sd">            m.data[&#39;hdr&#39;][&#39;nSpecs&#39;]</span>
<span class="sd">            </span>
<span class="sd">            m.data[&#39;state&#39;]  # dtype defined in self.stateFormat()</span>
<span class="sd">            m.data[&#39;state&#39;][&#39;gasT&#39;]    # shape = (nSteps)</span>
<span class="sd">            m.data[&#39;state&#39;][&#39;dustT&#39;]   # shape = (nSteps)</span>
<span class="sd">            m.data[&#39;state&#39;][&#39;Av&#39;]      # shape = (nSteps)</span>
<span class="sd">            m.data[&#39;state&#39;][&#39;abun&#39;]    # shape = (nSpecs, nSteps)</span>
<span class="sd">            </span>
<span class="sd">            m.data[&#39;therm&#39;] # dtype defined in self.thermoFormat()</span>
<span class="sd">            m.data[&#39;therm&#39;][&#39;heating&#39;] </span>
<span class="sd">            m.data[&#39;therm&#39;][&#39;cooling&#39;]</span>
<span class="sd">            </span>
<span class="sd">            m.data[&#39;cooling&#39;] # dtype defined in self.coolingFormat()</span>
<span class="sd">            m.data[&#39;cooling&#39;][&#39;metaStable&#39;]</span>
<span class="sd">            m.data[&#39;cooling&#39;][&#39;fineStructure&#39;]</span>
<span class="sd">            m.data[&#39;cooling&#39;][&#39;roVib&#39;]</span>
<span class="sd">            m.data[&#39;cooling&#39;][&#39;remainig tags in self.coolingFormat()&#39;]</span>
<span class="sd">            </span>
<span class="sd">            m.data[&#39;heating&#39;] # dtype defined in self.heatingFormat()</span>
<span class="sd">            m.data[&#39;heating&#39;][&#39;photo&#39;]</span>
<span class="sd">            m.data[&#39;heating&#39;][&#39;cIon&#39;]</span>
<span class="sd">            m.data[&#39;heating&#39;][&#39;molHydro&#39;]</span>
<span class="sd">            m.data[&#39;heating&#39;][&#39;remainig tags in self.heatingFormat()&#39;]</span>
<span class="sd">            </span>
<span class="sd">            # Only for binary files with version 2 have the follwing extra data</span>
<span class="sd">            m.data[&#39;metaStableCoolingCmponents&#39;] # dtype defined in self.coolingFormaMetaStable()</span>
<span class="sd">            m.data[&#39;metaStableCoolingCmponents&#39;][&#39;C&#39;]</span>
<span class="sd">            m.data[&#39;metaStableCoolingCmponents&#39;][&#39;C+&#39;]</span>
<span class="sd">            m.data[&#39;metaStableCoolingCmponents&#39;][&#39;Fe&#39;]</span>
<span class="sd">            m.data[&#39;metaStableCoolingCmponents&#39;][&#39;remainig species in self.coolingFormatMetaStable()&#39;]</span>
<span class="sd">            </span>
<span class="sd">            m.data[&#39;fineStructureCoolingComponents&#39;] # dtype defined in self.coolingFormatFineStructure()</span>
<span class="sd">            m.data[&#39;fineStructureCoolingComponents&#39;][&#39;Si&#39;][&#39;popDens&#39;][&#39;0&#39;]</span>
<span class="sd">            m.data[&#39;fineStructureCoolingComponents&#39;][&#39;Si&#39;][&#39;popDens&#39;][&#39;1&#39;]</span>
<span class="sd">            m.data[&#39;fineStructureCoolingComponents&#39;][&#39;Si&#39;][&#39;rate&#39;][&#39;1-0&#39;]</span>
<span class="sd">            m.data[&#39;fineStructureCoolingComponents&#39;][&#39;remainig species in self.coolingFormatFineStructure&#39;]</span>
<span class="sd">            </span>
<span class="sd">            m.data[&#39;selfSheilding&#39;]  # dtype defined in self.selfSheildingFormat()</span>
<span class="sd">            m.data[&#39;selfSheilding&#39;][&#39;H2&#39;]</span>
<span class="sd">            m.data[&#39;selfSheilding&#39;][&#39;CO&#39;]</span>
<span class="sd">            m.data[&#39;selfSheilding&#39;][&#39;13CO&#39;]</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fileName</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">chemNet</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">metallicity</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">fileName</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fName</span> <span class="o">=</span> <span class="n">fileName</span> <span class="c">#: path (py:string) of the binary file holding the data of the mesh.</span>
        
            <span class="c"># reading the header, constructing the full mesh dtype</span>
            <span class="n">dtHdr</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">headerFormat</span><span class="p">()</span> <span class="p">)</span> 
            <span class="n">hdr</span>   <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fName</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">dtHdr</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">1</span> <span class="p">)</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">hdr</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c">#: data of the header </span>

            <span class="c"># re-reading the whole file and constructing the full dtype</span>
            <span class="c"># with the header info read above </span>
            <span class="n">dtMesh</span>    <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">constructMeshDtype</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdr</span><span class="p">[</span><span class="s">&#39;nSpecs&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdr</span><span class="p">[</span><span class="s">&#39;nSteps&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">hdr</span><span class="p">[</span><span class="s">&#39;version&#39;</span><span class="p">])</span>
            <span class="n">data</span>      <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span> <span class="n">fileName</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">dtMesh</span><span class="p">,</span> <span class="n">count</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
            <span class="c">#print fileName</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> 
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="bp">None</span>  <span class="c">#: (numpy.dtype) holds all the data of the PDR</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hdr</span>  <span class="o">=</span> <span class="bp">None</span>  <span class="c">#: (numpy.dtype) holds the header info the PDR. This is the same as :data:`self.data[&#39;hdr&#39;] &lt;data&gt;`</span>
            
        <span class="k">if</span> <span class="n">chemNet</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_chemNet</span><span class="p">(</span><span class="n">chemNet</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">chemNet</span> <span class="o">=</span> <span class="bp">None</span> <span class="c">#:</span>

        <span class="k">if</span> <span class="n">metallicity</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_metallicity</span><span class="p">(</span><span class="n">metallicity</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">metallicity</span> <span class="o">=</span> <span class="bp">None</span> <span class="c">#:</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">figInit</span> <span class="o">=</span> <span class="mi">0</span>     <span class="c">#:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span>     <span class="o">=</span> <span class="bp">None</span>  <span class="c">#:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axs</span>     <span class="o">=</span> <span class="bp">None</span>  <span class="c">#:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axsRef</span>  <span class="o">=</span> <span class="bp">None</span>  <span class="c">#:</span>
        
        
<div class="viewcode-block" id="mesh.constructMeshDtype"><a class="viewcode-back" href="../index.html#mesh.mesh.constructMeshDtype">[docs]</a>    <span class="k">def</span> <span class="nf">constructMeshDtype</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nSpecs</span><span class="p">,</span> <span class="n">nSteps</span><span class="p">,</span> <span class="n">version</span> <span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; constructs the numpy dtype of the mesh which will be used to read the contents of the binary data fiel</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">meshFormat</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">meshFormat</span><span class="p">(</span> <span class="n">nSpecs</span><span class="p">,</span> <span class="n">nSteps</span><span class="p">,</span> <span class="n">version</span> <span class="p">)</span>
        <span class="n">meshDtype</span>  <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span> <span class="n">meshFormat</span> <span class="p">)</span>
        <span class="k">return</span>  <span class="n">meshDtype</span>
</div>
<div class="viewcode-block" id="mesh.meshFormat"><a class="viewcode-back" href="../index.html#mesh.mesh.meshFormat">[docs]</a>    <span class="k">def</span> <span class="nf">meshFormat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nSpecs</span><span class="p">,</span> <span class="n">nSteps</span><span class="p">,</span> <span class="n">version</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; define the format of the mesh from which the dtype is contrsucted.</span>
<span class="sd">        </span>
<span class="sd">             :param numpy.int32 nSpecs: number of species in the chemical network in the file</span>
<span class="sd">             :param numpy.int32 nSteps: number of slabs in the file</span>
<span class="sd">             :param numpy.int32: the version of the data file. For now can handle up to version = 2.</span>
<span class="sd">             :returns: list</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">dt</span> <span class="o">=</span>  <span class="p">[</span>  <span class="p">(</span><span class="s">&#39;hdr&#39;</span>    <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">headerFormat</span> <span class="p">()</span>               <span class="p">),</span> <span class="mi">1</span><span class="p">),</span>
                 <span class="p">(</span><span class="s">&#39;state&#39;</span>  <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">stateFormat</span>  <span class="p">(</span> <span class="n">nSpecs</span><span class="p">,</span> <span class="n">nSteps</span><span class="p">)),</span> <span class="mi">1</span><span class="p">),</span>
                 <span class="p">(</span><span class="s">&#39;therm&#39;</span>  <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">thermoFormat</span><span class="p">(</span> <span class="n">nSteps</span><span class="p">)</span>         <span class="p">),</span> <span class="mi">1</span><span class="p">),</span>
                 <span class="p">(</span><span class="s">&#39;heating&#39;</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">heatingFormat</span><span class="p">(</span> <span class="n">nSteps</span><span class="p">)</span>        <span class="p">),</span> <span class="mi">1</span><span class="p">),</span>
                 <span class="p">(</span><span class="s">&#39;cooling&#39;</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">coolingFormat</span><span class="p">(</span> <span class="n">nSteps</span><span class="p">)</span>        <span class="p">),</span> <span class="mi">1</span><span class="p">),</span>
              <span class="p">]</span>

        <span class="c"># if the data file version is the second version, append the rest of the </span>
        <span class="c"># file format to be read, detailed cooling and self sheilding stuff</span>
        <span class="k">if</span> <span class="n">version</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">dt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">(</span><span class="s">&#39;metaStableCoolingCmponents&#39;</span>    <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">coolingFormaMetaStable</span><span class="p">(</span><span class="n">nSteps</span><span class="p">))</span>    <span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">)</span>
            <span class="n">dt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">(</span><span class="s">&#39;fineStructureCoolingComponents&#39;</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">coolingFormatFineStructure</span><span class="p">(</span><span class="n">nSteps</span><span class="p">)),</span> <span class="mi">1</span><span class="p">),</span> <span class="p">)</span>
            <span class="n">dt</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">(</span><span class="s">&#39;selfSheilding&#39;</span>                 <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">selfSheildingFormat</span><span class="p">(</span> <span class="n">nSteps</span><span class="p">))</span>      <span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">)</span>
            
        <span class="k">return</span> <span class="n">dt</span>
    </div>
<div class="viewcode-block" id="mesh.headerFormat"><a class="viewcode-back" href="../index.html#mesh.mesh.headerFormat">[docs]</a>    <span class="k">def</span> <span class="nf">headerFormat</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; define and return the format of the mesh header.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="p">[</span> 
                  <span class="p">(</span><span class="s">&#39;version&#39;</span>  <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">int32</span>   <span class="p">),</span>
                  <span class="p">(</span><span class="s">&#39;G0&#39;</span>       <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span> <span class="p">),</span>
                  <span class="p">(</span><span class="s">&#39;nGas&#39;</span>     <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span> <span class="p">),</span>
                  <span class="p">(</span><span class="s">&#39;gammaMech&#39;</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span> <span class="p">),</span>
                  <span class="p">(</span><span class="s">&#39;nSteps&#39;</span>   <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">int32</span>   <span class="p">),</span>
                  <span class="p">(</span><span class="s">&#39;nSpecs&#39;</span>   <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">int32</span>   <span class="p">),</span>
               <span class="p">]</span>
        </div>
<div class="viewcode-block" id="mesh.stateFormat"><a class="viewcode-back" href="../index.html#mesh.mesh.stateFormat">[docs]</a>    <span class="k">def</span> <span class="nf">stateFormat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nSpecs</span><span class="p">,</span> <span class="n">nSteps</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; define the format of the state of the mesh.&quot;&quot;&quot;</span>
        
        <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nSteps</span><span class="p">)</span>
        <span class="n">m</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nSpecs</span><span class="p">)</span>
        <span class="n">fmt</span> <span class="o">=</span> <span class="p">[</span>
                  <span class="p">(</span><span class="s">&#39;gasT&#39;</span>  <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span> <span class="n">n</span><span class="p">)</span> <span class="p">),</span>
                  <span class="p">(</span><span class="s">&#39;dustT&#39;</span> <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span> <span class="n">n</span><span class="p">)</span> <span class="p">),</span>
                  <span class="p">(</span><span class="s">&#39;Av&#39;</span>    <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span> <span class="n">n</span><span class="p">)</span> <span class="p">),</span>
                  <span class="p">(</span><span class="s">&#39;abun&#39;</span>  <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="p">),</span>
               <span class="p">]</span>
        <span class="k">return</span> <span class="n">fmt</span>
    </div>
<div class="viewcode-block" id="mesh.thermoFormat"><a class="viewcode-back" href="../index.html#mesh.mesh.thermoFormat">[docs]</a>    <span class="k">def</span> <span class="nf">thermoFormat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nSteps</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; define the format of the total heating and cooling.&quot;&quot;&quot;</span>

        <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nSteps</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span>
                  <span class="p">(</span><span class="s">&#39;heating&#39;</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">),</span>
                  <span class="p">(</span><span class="s">&#39;cooling&#39;</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">),</span>
               <span class="p">]</span>
</div>
<div class="viewcode-block" id="mesh.heatingFormat"><a class="viewcode-back" href="../index.html#mesh.mesh.heatingFormat">[docs]</a>    <span class="k">def</span> <span class="nf">heatingFormat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nSteps</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; define the format of the heating components.&quot;&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nSteps</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span>
                  <span class="p">(</span><span class="s">&#39;photo&#39;</span>    <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">),</span>
                  <span class="p">(</span><span class="s">&#39;cIon&#39;</span>     <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">),</span>
                  <span class="p">(</span><span class="s">&#39;molHydro&#39;</span> <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">),</span>
                  <span class="p">(</span><span class="s">&#39;H2pump&#39;</span>   <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">),</span>
                  <span class="p">(</span><span class="s">&#39;ggColl&#39;</span>   <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">),</span>
                  <span class="p">(</span><span class="s">&#39;visc&#39;</span>     <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">),</span>
                  <span class="p">(</span><span class="s">&#39;cr&#39;</span>       <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">),</span>
               <span class="p">]</span>
</div>
<div class="viewcode-block" id="mesh.coolingFormat"><a class="viewcode-back" href="../index.html#mesh.mesh.coolingFormat">[docs]</a>    <span class="k">def</span> <span class="nf">coolingFormat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nSteps</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; define the format of the cooling components.&quot;&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">nSteps</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span>
                  <span class="p">(</span><span class="s">&#39;metaStable&#39;</span>    <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span> <span class="n">n</span><span class="p">)</span> <span class="p">),</span>
                  <span class="p">(</span><span class="s">&#39;fineStructure&#39;</span> <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span> <span class="n">n</span><span class="p">)</span> <span class="p">),</span>
                  <span class="p">(</span><span class="s">&#39;roVib&#39;</span>         <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span> <span class="n">n</span><span class="p">)</span> <span class="p">),</span>
                  <span class="p">(</span><span class="s">&#39;recom&#39;</span>         <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span> <span class="n">n</span><span class="p">)</span> <span class="p">),</span>
                  <span class="p">(</span><span class="s">&#39;lymanAlpha&#39;</span>    <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span> <span class="n">n</span><span class="p">)</span> <span class="p">),</span>
               <span class="p">]</span>
</div>
<div class="viewcode-block" id="mesh.coolingFormaMetaStable"><a class="viewcode-back" href="../index.html#mesh.mesh.coolingFormaMetaStable">[docs]</a>    <span class="k">def</span> <span class="nf">coolingFormaMetaStable</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nSteps</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; define the format of the meta stable cooling components.&quot;&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">nSteps</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span>
                  <span class="p">(</span><span class="s">&#39;C&#39;</span>  <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">),</span>
                  <span class="p">(</span><span class="s">&#39;C+&#39;</span> <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">),</span>
                  <span class="p">(</span><span class="s">&#39;Fe&#39;</span> <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">),</span>
                  <span class="p">(</span><span class="s">&#39;Fe+&#39;</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">),</span>
                  <span class="p">(</span><span class="s">&#39;O&#39;</span>  <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">),</span>
                  <span class="p">(</span><span class="s">&#39;O+&#39;</span> <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">),</span>
                  <span class="p">(</span><span class="s">&#39;S&#39;</span>  <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">),</span>
                  <span class="p">(</span><span class="s">&#39;S+&#39;</span> <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">),</span>
                  <span class="p">(</span><span class="s">&#39;Si&#39;</span> <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">),</span>
                  <span class="p">(</span><span class="s">&#39;Si+&#39;</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="p">),</span>
               <span class="p">]</span>

    <span class="c"># tansitions = [&#39;upper1-lower1&#39;, &#39;upper2-lower2&#39;....etc ]</span>
    <span class="c">#   for example </span>
    <span class="c"># tansitions = [&#39;1-0&#39;, &#39;2-1&#39;....etc ]#</span></div>
<div class="viewcode-block" id="mesh.coolingFmtFsSpecie"><a class="viewcode-back" href="../index.html#mesh.mesh.coolingFmtFsSpecie">[docs]</a>    <span class="k">def</span> <span class="nf">coolingFmtFsSpecie</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">levels</span><span class="p">,</span> <span class="n">transitions</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; define the format of fine structure cooling transitions of a certain specie.</span>
<span class="sd">        </span>
<span class="sd">             :param list levels: a list of strings for the names of the levels which can be used to access the population densities. For example :</span>

<span class="sd">             .. code-block:: python</span>
<span class="sd">             </span>
<span class="sd">                 levels = [&#39;0&#39;, &#39;1&#39;, &#39;2&#39;, &#39;3&#39;, &#39;3-p&#39;]</span>
<span class="sd">                 </span>
<span class="sd">             would allow for the abundances of each level to be accessed through :</span>
<span class="sd">             </span>
<span class="sd">             .. code-block:: python</span>
<span class="sd">             </span>
<span class="sd">                 [&#39;SPECIE&#39;][&#39;popDens&#39;][&#39;0&#39;] # numpy.float64 array of the population density of level &#39;0&#39; </span>
<span class="sd">                 [&#39;SPECIE&#39;][&#39;popDens&#39;][&#39;1&#39;] # numpy.float64 array of the population density of level &#39;1&#39;</span>

<span class="sd">             :param list transitions: a list containing the transitions. For each transitions an array is created as a dtype which can be used to access the cooling rate. For example.</span>

<span class="sd">             .. code-block:: python</span>
<span class="sd">             </span>
<span class="sd">                 transitions = [&#39;1-0&#39;,&#39;2-1&#39;,&#39;2-0&#39;]</span>

<span class="sd">             would allow for the cooling rates for the transitions to be accessed through :</span>
<span class="sd">             </span>
<span class="sd">             .. code-block:: python</span>
<span class="sd">             </span>
<span class="sd">                 [&#39;SPECIE&#39;][&#39;rate&#39;][&#39;1-0&#39;] # numpy.float64 array of the cooling rate for transition &#39;1-0&#39; </span>
<span class="sd">                 [&#39;SPECIE&#39;][&#39;rate&#39;][&#39;2-1&#39;] # numpy.float64 array of the cooling rate for transition &#39;2-1&#39; </span>
<span class="sd">            </span>
<span class="sd">             :param numpy.int32 n: the number of steps which will be the size of all the numpy.float64 arrays mentioned above             </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">fmtCool</span>    <span class="o">=</span> <span class="p">[]</span>
        <span class="n">fmtPopDens</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="k">for</span> <span class="n">trans</span> <span class="ow">in</span> <span class="n">transitions</span><span class="p">:</span>
            <span class="n">fmtCool</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>     <span class="p">(</span><span class="n">trans</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">)),</span>   <span class="p">)</span>
        <span class="k">for</span> <span class="n">level</span> <span class="ow">in</span> <span class="n">levels</span><span class="p">:</span>
            <span class="n">fmtPopDens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>  <span class="p">(</span><span class="n">level</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="n">n</span><span class="p">)),</span>   <span class="p">)</span>
            
        <span class="k">return</span> <span class="p">[</span>           
                 <span class="p">(</span><span class="s">&#39;rate&#39;</span>   <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">fmtCool</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span>
                 <span class="p">(</span><span class="s">&#39;popDens&#39;</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="n">fmtPopDens</span><span class="p">),</span> <span class="mi">1</span><span class="p">),</span>
               <span class="p">]</span>
        </div>
<div class="viewcode-block" id="mesh.coolingFormatFineStructure"><a class="viewcode-back" href="../index.html#mesh.mesh.coolingFormatFineStructure">[docs]</a>    <span class="k">def</span> <span class="nf">coolingFormatFineStructure</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nSteps</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; defines the format of the contents of each specie&#39;s fine structure cooling info</span>
<span class="sd">            </span>
<span class="sd">            :param numpy.int32 nSteps: the number of steps in the mesh to be set as the size of the arrays holding the fine structure info for the cooling rate and population densitites for each transition and level respectively.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">n</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">int32</span><span class="p">(</span><span class="n">nSteps</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span> <span class="p">(</span><span class="s">&#39;C+&#39;</span> <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coolingFmtFsSpecie</span><span class="p">([</span><span class="s">&#39;0&#39;</span><span class="p">,</span><span class="s">&#39;1&#39;</span><span class="p">]</span>    <span class="p">,</span> <span class="p">[</span><span class="s">&#39;1-0&#39;</span><span class="p">]</span>            <span class="p">,</span> <span class="n">n</span><span class="p">)),</span> <span class="mi">1</span><span class="p">),</span>
                 <span class="p">(</span><span class="s">&#39;Si+&#39;</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coolingFmtFsSpecie</span><span class="p">([</span><span class="s">&#39;0&#39;</span><span class="p">,</span><span class="s">&#39;1&#39;</span><span class="p">]</span>    <span class="p">,</span> <span class="p">[</span><span class="s">&#39;1-0&#39;</span><span class="p">]</span>            <span class="p">,</span> <span class="n">n</span><span class="p">)),</span> <span class="mi">1</span><span class="p">),</span>
                 <span class="p">(</span><span class="s">&#39;C&#39;</span>  <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coolingFmtFsSpecie</span><span class="p">([</span><span class="s">&#39;0&#39;</span><span class="p">,</span><span class="s">&#39;1&#39;</span><span class="p">,</span><span class="s">&#39;2&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s">&#39;1-0&#39;</span><span class="p">,</span><span class="s">&#39;2-1&#39;</span><span class="p">,</span><span class="s">&#39;2-0&#39;</span><span class="p">],</span> <span class="n">n</span><span class="p">)),</span> <span class="mi">1</span><span class="p">),</span>
                 <span class="p">(</span><span class="s">&#39;O&#39;</span>  <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coolingFmtFsSpecie</span><span class="p">([</span><span class="s">&#39;0&#39;</span><span class="p">,</span><span class="s">&#39;1&#39;</span><span class="p">,</span><span class="s">&#39;2&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s">&#39;1-0&#39;</span><span class="p">,</span><span class="s">&#39;2-1&#39;</span><span class="p">,</span><span class="s">&#39;2-0&#39;</span><span class="p">],</span> <span class="n">n</span><span class="p">)),</span> <span class="mi">1</span><span class="p">),</span>
                 <span class="p">(</span><span class="s">&#39;S&#39;</span>  <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coolingFmtFsSpecie</span><span class="p">([</span><span class="s">&#39;0&#39;</span><span class="p">,</span><span class="s">&#39;1&#39;</span><span class="p">,</span><span class="s">&#39;2&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s">&#39;1-0&#39;</span><span class="p">,</span><span class="s">&#39;2-1&#39;</span><span class="p">,</span><span class="s">&#39;2-0&#39;</span><span class="p">],</span> <span class="n">n</span><span class="p">)),</span> <span class="mi">1</span><span class="p">),</span>
                 <span class="p">(</span><span class="s">&#39;Fe+&#39;</span><span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coolingFmtFsSpecie</span><span class="p">([</span><span class="s">&#39;0&#39;</span><span class="p">,</span><span class="s">&#39;1&#39;</span><span class="p">,</span><span class="s">&#39;2&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s">&#39;1-0&#39;</span><span class="p">,</span><span class="s">&#39;2-1&#39;</span><span class="p">,</span><span class="s">&#39;2-0&#39;</span><span class="p">],</span> <span class="n">n</span><span class="p">)),</span> <span class="mi">1</span><span class="p">),</span>
                 <span class="p">(</span><span class="s">&#39;Si&#39;</span> <span class="p">,</span> <span class="n">numpy</span><span class="o">.</span><span class="n">dtype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">coolingFmtFsSpecie</span><span class="p">([</span><span class="s">&#39;0&#39;</span><span class="p">,</span><span class="s">&#39;1&#39;</span><span class="p">,</span><span class="s">&#39;2&#39;</span><span class="p">],</span> <span class="p">[</span><span class="s">&#39;1-0&#39;</span><span class="p">,</span><span class="s">&#39;2-1&#39;</span><span class="p">,</span><span class="s">&#39;2-0&#39;</span><span class="p">],</span> <span class="n">n</span><span class="p">)),</span> <span class="mi">1</span><span class="p">),</span>
                <span class="p">]</span>
</div>
<div class="viewcode-block" id="mesh.selfSheildingFormat"><a class="viewcode-back" href="../index.html#mesh.mesh.selfSheildingFormat">[docs]</a>    <span class="k">def</span> <span class="nf">selfSheildingFormat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nSteps</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; defines the format of the arrays which will hold the self sheilding data for the slabs in the mesh.</span>
<span class="sd">         </span>
<span class="sd">        :param numpy.int32 nSteps: the number of steps in the mesh to be set as the size of the arrays holding the fine structure info for the cooling rate and population densitites for each transition and level respectively.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span> <span class="p">(</span><span class="s">&#39;H2&#39;</span>  <span class="p">,</span>  <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="n">nSteps</span><span class="p">)),</span>
                 <span class="p">(</span><span class="s">&#39;CO&#39;</span>  <span class="p">,</span>  <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="n">nSteps</span><span class="p">)),</span>
                 <span class="p">(</span><span class="s">&#39;13CO&#39;</span><span class="p">,</span>  <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span><span class="p">,</span> <span class="p">(</span><span class="n">nSteps</span><span class="p">)),</span>
               <span class="p">]</span> </div>
<div class="viewcode-block" id="mesh.getColumnDensity"><a class="viewcode-back" href="../index.html#mesh.mesh.getColumnDensity">[docs]</a>    <span class="k">def</span> <span class="nf">getColumnDensity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">specsStrs</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">maxAv</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;returns a list of the same lenght as specsStrs containing the column densities</span>
<span class="sd">           of the species in the list specsStrs. It is assumed that self.chemNet, </span>
<span class="sd">           self.metallicity and self.data are set.</span>
<span class="sd">           </span>
<span class="sd">           :param list specsStrs: a list which holds the string names of the species</span>
<span class="sd">               whose column densities are to be computed. This MUST be a list, even if it</span>
<span class="sd">               is one species.</span>
<span class="sd">           :param chemicalNetwork.chemicalNetwork() chemNet: an instance of the object chemicalNetwork</span>
<span class="sd">            that holds the info about all the chemistry of the mesh. If this is not passed, self.chemNet </span>
<span class="sd">            is used (assuming it is set).</span>
<span class="sd">            </span>
<span class="sd">           :todo: make use of self.compute_integrated_quantity in this method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">specsStrs</span><span class="o">.</span><span class="n">__class__</span> <span class="ow">is</span> <span class="ow">not</span> <span class="p">[]</span><span class="o">.</span><span class="n">__class__</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&#39;the parameter specsStrs is not a list.&#39;</span><span class="p">)</span>
        
        <span class="n">colDensities</span> <span class="o">=</span> <span class="p">[]</span>
        
        <span class="c"># getting mesh parameters</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
        <span class="n">nDense_m</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;hdr&#39;</span><span class="p">][</span><span class="s">&#39;nGas&#39;</span><span class="p">]</span> 
        <span class="n">abun_m</span>   <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;abun&#39;</span><span class="p">]</span>
        <span class="n">Av_m</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;Av&#39;</span><span class="p">]</span>

        <span class="c"># setting the thickness of the last slab to the one before it</span>
        <span class="n">dxSlabs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_dx</span><span class="p">()</span> 
        
        <span class="k">if</span> <span class="n">maxAv</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">slabsIdx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;hdr&#39;</span><span class="p">][</span><span class="s">&#39;nSteps&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">slabsIdx</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">where</span><span class="p">(</span> <span class="n">Av_m</span> <span class="o">&lt;</span> <span class="n">maxAv</span><span class="p">)</span>

        <span class="c"># computing the column densities for the species in the list</span>
        <span class="k">for</span> <span class="n">specStr</span> <span class="ow">in</span> <span class="n">specsStrs</span><span class="p">:</span>
            <span class="n">specIdx</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chemNet</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">specStr</span><span class="p">]</span><span class="o">.</span><span class="n">num</span>
            <span class="n">nDensSpec</span> <span class="o">=</span> <span class="n">nDense_m</span> <span class="o">*</span> <span class="n">abun_m</span><span class="p">[</span> <span class="n">specIdx</span> <span class="p">][</span> <span class="p">:</span> <span class="p">]</span>
            <span class="n">NSpec</span> <span class="o">=</span> <span class="n">dxSlabs</span><span class="p">[</span><span class="n">slabsIdx</span><span class="p">]</span> <span class="o">*</span> <span class="n">nDensSpec</span><span class="p">[</span><span class="n">slabsIdx</span><span class="p">]</span>
            <span class="n">colDens</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span> <span class="n">NSpec</span> <span class="p">)</span>
            <span class="n">colDensities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">colDens</span> <span class="p">)</span>

        <span class="k">return</span> <span class="n">colDensities</span>
</div>
    <span class="k">def</span> <span class="nf">getData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
    
    <span class="k">def</span> <span class="nf">saveData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fName</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">tofile</span><span class="p">(</span> <span class="n">fName</span> <span class="p">)</span>

    <span class="k">def</span> <span class="nf">toBuffer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fObj</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">tofile</span><span class="p">(</span> <span class="n">fObj</span> <span class="p">)</span>

    <span class="k">def</span> <span class="nf">setData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
    
    <span class="k">def</span> <span class="nf">setFigureObjects</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">figObj</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">axObj</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="n">figObj</span> <span class="o">!=</span> <span class="bp">None</span> <span class="ow">and</span> <span class="n">axObj</span> <span class="o">!=</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">figObj</span><span class="p">,</span> <span class="n">axObj</span> <span class="o">=</span> <span class="n">pylab</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">12</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">fig</span>     <span class="o">=</span> <span class="n">figObj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axs</span>     <span class="o">=</span> <span class="n">axObj</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figInit</span> <span class="o">=</span> <span class="mi">1</span>
        
<div class="viewcode-block" id="mesh.setupFigures"><a class="viewcode-back" href="../index.html#mesh.mesh.setupFigures">[docs]</a>    <span class="k">def</span> <span class="nf">setupFigures</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">plot_Av_range</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Setup the ranges, labels...etc..for the plots.</span>
<span class="sd">        </span>
<span class="sd">           :param list plot_Av_range: a list holding the (min, max) of the x axis.  </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="k">if</span> <span class="n">plot_Av_range</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">plot_x_range</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">plot_x_range</span> <span class="o">=</span> <span class="n">plot_Av_range</span>
            
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">figInit</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setFigureObjects</span><span class="p">()</span>
            
        <span class="c"># subplot 0,0        </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt00tgasPlt</span><span class="p">,</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;r&#39;</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt00tdustPlt</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;b&#39;</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt00_v_line</span><span class="p">,</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;k--&#39;</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">plot_x_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">plot_x_range</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;$T(K)$&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">1e3</span><span class="p">,</span> <span class="s">&#39;$T_{gas}$&#39;</span> <span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">1e4</span><span class="p">,</span> <span class="s">&#39;$T_{dust}$&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;b&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt00Ttl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.8</span><span class="p">,</span> <span class="mf">5e5</span><span class="p">,</span><span class="s">&#39;$\log_{10} G_0 = $ </span><span class="si">%4.2f</span><span class="s"> $\log_{10} n_{gas} = $ </span><span class="si">%4.2f</span><span class="s">  $\log_{10} \Gamma_{mech} = $  </span><span class="si">%5.2f</span><span class="se">\n</span><span class="s"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span> <span class="p">)</span> <span class="p">)</span>
        <span class="c"># enabling y ticks on the second axis</span>
        <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_major_ticks</span><span class="p">():</span>
            <span class="n">tick</span><span class="o">.</span><span class="n">label1On</span> <span class="o">=</span> <span class="bp">False</span>
        
        <span class="c"># subplot 0,1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt01Spec1Plt</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;r&#39;</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt01Spec2Plt</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;g&#39;</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt01Spec3Plt</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;b&#39;</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt01Spec4Plt</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;c&#39;</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt01Spec5Plt</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;y&#39;</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt01_v_line</span><span class="p">,</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;k--&#39;</span> <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="s">&#39;$H^+$&#39;</span> <span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">1e-9</span> <span class="p">,</span> <span class="s">&#39;$H$&#39;</span>   <span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;g&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">1e-8</span> <span class="p">,</span> <span class="s">&#39;$H_2$&#39;</span> <span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;b&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">1e-11</span> <span class="p">,</span><span class="s">&#39;$e^-$&#39;</span> <span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">1e-12</span> <span class="p">,</span><span class="s">&#39;$He$&#39;</span>  <span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;y&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt01ax1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plt01ax1</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_major_ticks</span><span class="p">():</span>
            <span class="n">tick</span><span class="o">.</span><span class="n">label1On</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt01ax2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>

        <span class="c"># redundant, but we do it just to get the right ticks on the y axis</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt01ax2</span><span class="o">.</span><span class="n">semilogy</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;g&#39;</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt01ax2</span><span class="o">.</span><span class="n">semilogy</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;b&#39;</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt01ax2</span><span class="o">.</span><span class="n">semilogy</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;c&#39;</span> <span class="p">)</span>

        <span class="c"># deleting all the ticks on the first axis</span>
        <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plt01ax1</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">get_major_ticks</span><span class="p">():</span>
            <span class="n">tick</span><span class="o">.</span><span class="n">label1On</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">tick</span><span class="o">.</span><span class="n">label2On</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="c"># enabling y ticks on the second axis</span>
        <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">plt01ax2</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">get_major_ticks</span><span class="p">():</span>
            <span class="n">tick</span><span class="o">.</span><span class="n">label1On</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">tick</span><span class="o">.</span><span class="n">label2On</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt01ax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;abun&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">plot_x_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">plot_x_range</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1e-12</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

        <span class="c"># subplot 1,0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt10Spec1Plt</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;r&#39;</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt10Spec2Plt</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;g&#39;</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt10Spec3Plt</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;b&#39;</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt10Spec4Plt</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;c&#39;</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt10_v_line</span><span class="p">,</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;k--&#39;</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">plot_x_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">plot_x_range</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1e-12</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">1e-11</span><span class="p">,</span> <span class="s">&#39;$O$&#39;</span>   <span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;c&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="s">&#39;$C^+$&#39;</span> <span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">1e-9</span> <span class="p">,</span> <span class="s">&#39;$C$&#39;</span>   <span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;g&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">1e-8</span> <span class="p">,</span> <span class="s">&#39;$CO$&#39;</span>  <span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;b&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;$A_V$&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s">&#39;abun&#39;</span><span class="p">)</span>
        
        <span class="c">#subplot 1,1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt11Spec1Plt</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;r&#39;</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt11Spec2Plt</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;g&#39;</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt11Spec3Plt</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;b&#39;</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt11_v_line</span><span class="p">,</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">semilogy</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span>  <span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="s">&#39;k--&#39;</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="n">plot_x_range</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">plot_x_range</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1e-12</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>   
        <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">,</span> <span class="s">&#39;$HCN$&#39;</span>  <span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;r&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">1e-9</span> <span class="p">,</span> <span class="s">&#39;$HNC$&#39;</span>  <span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;g&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">1e-8</span> <span class="p">,</span> <span class="s">&#39;$HCO^+$&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s">&#39;b&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s">&#39;$A_V$&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">get_major_ticks</span><span class="p">():</span>
            <span class="n">tick</span><span class="o">.</span><span class="n">label1On</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="n">pylab</span><span class="o">.</span><span class="n">setp</span><span class="p">(</span><span class="n">pylab</span><span class="o">.</span><span class="n">gca</span><span class="p">(),</span> <span class="n">yticks</span><span class="o">=</span><span class="p">[])</span>
    </div>
<div class="viewcode-block" id="mesh.plot_v_lines_used_in_chemnet"><a class="viewcode-back" href="../index.html#mesh.mesh.plot_v_lines_used_in_chemnet">[docs]</a>    <span class="k">def</span> <span class="nf">plot_v_lines_used_in_chemnet</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;plotting the vertical lines on the gui indicating the positions</span>
<span class="sd">           in the slab used for the chemistry.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plt00_v_line</span><span class="o">.</span><span class="n">set_xdata</span><span class="p">(</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chemNet</span><span class="o">.</span><span class="n">Av</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">chemNet</span><span class="o">.</span><span class="n">Av</span><span class="p">]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt00_v_line</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100000</span><span class="p">])</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">plt01_v_line</span><span class="o">.</span><span class="n">set_xdata</span><span class="p">(</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chemNet</span><span class="o">.</span><span class="n">Av</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">chemNet</span><span class="o">.</span><span class="n">Av</span><span class="p">]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt01_v_line</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span> <span class="p">[</span><span class="mf">1e-12</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">plt10_v_line</span><span class="o">.</span><span class="n">set_xdata</span><span class="p">(</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chemNet</span><span class="o">.</span><span class="n">Av</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">chemNet</span><span class="o">.</span><span class="n">Av</span><span class="p">]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt10_v_line</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span> <span class="p">[</span><span class="mf">1e-12</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">plt11_v_line</span><span class="o">.</span><span class="n">set_xdata</span><span class="p">(</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">chemNet</span><span class="o">.</span><span class="n">Av</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">chemNet</span><span class="o">.</span><span class="n">Av</span><span class="p">]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt11_v_line</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span> <span class="p">[</span><span class="mf">1e-12</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

        </div>
    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">chemNet</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">strng</span> <span class="o">=</span> <span class="s">&quot;Error : chemical network object not set.&quot;</span> 
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="n">strng</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">chemNet</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chemNet</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">figInit</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setupFigures</span><span class="p">()</span>
            
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
        <span class="n">spcs</span> <span class="o">=</span> <span class="n">chemNet</span><span class="o">.</span><span class="n">species</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">fig</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fig</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axs</span> <span class="o">=</span> <span class="n">pylab</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">sharey</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span> 

        <span class="c"># subplot 0,0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt00tgasPlt</span><span class="o">.</span><span class="n">set_xdata</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;Av&#39;</span><span class="p">]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt00tgasPlt</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;gasT&#39;</span><span class="p">]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt00tdustPlt</span><span class="o">.</span><span class="n">set_xdata</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;Av&#39;</span><span class="p">]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt00tdustPlt</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;dustT&#39;</span><span class="p">]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt00Ttl</span><span class="o">.</span><span class="n">set_text</span><span class="p">(</span><span class="s">&#39;$\log_{10} G_0 = $ </span><span class="si">%4.2f</span><span class="s"> $\log_{10} n_{gas} = $ </span><span class="si">%4.2f</span><span class="s">  $\log_{10} \Gamma_{mech} = $  </span><span class="si">%5.2f</span><span class="se">\n</span><span class="s"> &#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;hdr&#39;</span><span class="p">][</span><span class="s">&#39;G0&#39;</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;hdr&#39;</span><span class="p">][</span><span class="s">&#39;nGas&#39;</span><span class="p">]),</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;hdr&#39;</span><span class="p">][</span><span class="s">&#39;gammaMech&#39;</span><span class="p">])</span> <span class="p">)</span> <span class="p">)</span>
        
        <span class="c"># subplot 0,1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt01Spec1Plt</span><span class="o">.</span><span class="n">set_xdata</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;Av&#39;</span><span class="p">]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt01Spec1Plt</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;abun&#39;</span><span class="p">][</span><span class="n">spcs</span><span class="p">[</span><span class="s">&#39;H+&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">num</span><span class="p">]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt01Spec2Plt</span><span class="o">.</span><span class="n">set_xdata</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;Av&#39;</span><span class="p">]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt01Spec2Plt</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;abun&#39;</span><span class="p">][</span><span class="n">spcs</span><span class="p">[</span><span class="s">&#39;H&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">num</span><span class="p">]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt01Spec3Plt</span><span class="o">.</span><span class="n">set_xdata</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;Av&#39;</span><span class="p">]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt01Spec3Plt</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;abun&#39;</span><span class="p">][</span><span class="n">spcs</span><span class="p">[</span><span class="s">&#39;H2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">num</span><span class="p">]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt01Spec4Plt</span><span class="o">.</span><span class="n">set_xdata</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;Av&#39;</span><span class="p">]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt01Spec4Plt</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;abun&#39;</span><span class="p">][</span><span class="n">spcs</span><span class="p">[</span><span class="s">&#39;e-&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">num</span><span class="p">]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt01Spec5Plt</span><span class="o">.</span><span class="n">set_xdata</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;Av&#39;</span><span class="p">]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt01Spec5Plt</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;abun&#39;</span><span class="p">][</span><span class="n">spcs</span><span class="p">[</span><span class="s">&#39;He&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">num</span><span class="p">]</span> <span class="p">)</span>
        
        <span class="c"># subplot 1,0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt10Spec1Plt</span><span class="o">.</span><span class="n">set_xdata</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;Av&#39;</span><span class="p">]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt10Spec1Plt</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;abun&#39;</span><span class="p">][</span><span class="n">spcs</span><span class="p">[</span><span class="s">&#39;C+&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">num</span><span class="p">]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt10Spec2Plt</span><span class="o">.</span><span class="n">set_xdata</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;Av&#39;</span><span class="p">]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt10Spec2Plt</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;abun&#39;</span><span class="p">][</span><span class="n">spcs</span><span class="p">[</span><span class="s">&#39;C&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">num</span><span class="p">]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt10Spec3Plt</span><span class="o">.</span><span class="n">set_xdata</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;Av&#39;</span><span class="p">]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt10Spec3Plt</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;abun&#39;</span><span class="p">][</span><span class="n">spcs</span><span class="p">[</span><span class="s">&#39;CO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">num</span><span class="p">]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt10Spec4Plt</span><span class="o">.</span><span class="n">set_xdata</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;Av&#39;</span><span class="p">]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt10Spec4Plt</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;abun&#39;</span><span class="p">][</span><span class="n">spcs</span><span class="p">[</span><span class="s">&#39;O&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">num</span><span class="p">]</span> <span class="p">)</span>

        <span class="c"># subplot 1,1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt11Spec1Plt</span><span class="o">.</span><span class="n">set_xdata</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;Av&#39;</span><span class="p">]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt11Spec1Plt</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;abun&#39;</span><span class="p">][</span><span class="n">spcs</span><span class="p">[</span><span class="s">&#39;HCN&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">num</span><span class="p">]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt11Spec2Plt</span><span class="o">.</span><span class="n">set_xdata</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;Av&#39;</span><span class="p">]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt11Spec2Plt</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;abun&#39;</span><span class="p">][</span><span class="n">spcs</span><span class="p">[</span><span class="s">&#39;HNC&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">num</span><span class="p">]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt11Spec3Plt</span><span class="o">.</span><span class="n">set_xdata</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;Av&#39;</span><span class="p">]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plt11Spec3Plt</span><span class="o">.</span><span class="n">set_ydata</span><span class="p">(</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;abun&#39;</span><span class="p">][</span><span class="n">spcs</span><span class="p">[</span><span class="s">&#39;HCO+&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">num</span><span class="p">]</span> <span class="p">)</span>
        
        
        <span class="sd">&quot;&quot;&quot;;;;remove those later;;;&quot;&quot;&quot;</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        m = data</span>
<span class="sd">        nDense_m = m[&#39;hdr&#39;][&#39;nGas&#39;]</span>
<span class="sd">        Av_m = m[&#39;state&#39;][&#39;Av&#39;]</span>
<span class="sd">        y = data[&#39;fineStructureCoolingComponents&#39;][&#39;C+&#39;][&#39;rate&#39;][&#39;1-0&#39;]</span>
<span class="sd">        </span>
<span class="sd">        # setting the thickness of the last slab to the one before it</span>
<span class="sd">        dxSlabs = self.compute_dx()</span>
<span class="sd">        </span>
<span class="sd">        q = y</span>
<span class="sd">        v = numpy.sum( q*dxSlabs ) / (2.0 * numpy.pi)</span>
<span class="sd">        print &#39;;;;&#39;, y</span>
<span class="sd">        print &#39;;;;&#39;, dxSlabs</span>
<span class="sd">        print &#39;;;;&#39;, q*dxSlabs</span>
<span class="sd">        </span>
<span class="sd">        self.axs[1,1].set_ylim(1e-10, 1e-0)   </span>
<span class="sd">        self.plt11Spec1Plt.set_xdata( data[&#39;state&#39;][&#39;Av&#39;] )</span>
<span class="sd">        self.plt11Spec1Plt.set_ydata( q*dxSlabs )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="sd">&quot;&quot;&quot;;;;remove those later;;;&quot;&quot;&quot;</span>

        
    <span class="c">## computes the average temperature, weighted by the column density of the XX</span>
    <span class="c">#  specie. which collides with YY_i other species. The average density of the </span>
    <span class="c">#  YY_i species is also weighed by the column density of the specie XX in each</span>
    <span class="c">#  slab. Only slabs which have abundances greater than XX_threshold are taken</span>
    <span class="c">#  into account in computing N(XX) and the average collider densities and the </span>
    <span class="c">#  average temepratures.</span>
<div class="viewcode-block" id="mesh.getRadexParameters"><a class="viewcode-back" href="../index.html#mesh.mesh.getRadexParameters">[docs]</a>    <span class="k">def</span> <span class="nf">getRadexParameters</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">speciesStr</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">threshold</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns a list (TMean, nDenseColl, N_specLVG which are </span>
<span class="sd">        the weighted averaged temperature, number density of the collider species and the</span>
<span class="sd">        column density of speciesStr. </span>

<span class="sd">        :param string speciesStr: the sting of the species whose column desnity is to be returned.</span>
<span class="sd">          (note use the function self.getColumnDensity()).</span>
<span class="sd">        :param float threshold: only slabs with an abundance bigger than threshold are considered</span>
<span class="sd">          in computing the column density anf the Tmean. Set this to a negative number to make sure</span>
<span class="sd">          all the slabs are considered.</span>
<span class="sd">        :return: (TMean, nDenseColl, N_specLVG)\n  </span>
<span class="sd">          TMean (flaot)\n</span>
<span class="sd">          nDenseColl (dict) : the number density of the colliders e-, H+, H, He, H2 which are the keys</span>
<span class="sd">            of the dict holding the corresponding number densities.\n</span>
<span class="sd">          N_spcLVG (float)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">spec</span> <span class="o">=</span> <span class="n">speciesStr</span>
        <span class="n">xMin</span> <span class="o">=</span> <span class="n">threshold</span>
        
        <span class="c"># checking the metallciity</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">metallicity</span> <span class="o">==</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">strng</span> <span class="o">=</span> <span class="s">&quot;Error : metallicity of mesh not set&quot;</span>
            <span class="k">raise</span> <span class="ne">NameError</span><span class="p">(</span><span class="n">strng</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">metallicity</span>
            
        <span class="n">m</span>   <span class="o">=</span> <span class="bp">self</span>
        <span class="n">net</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">chemNet</span> 
        
        <span class="n">nGas</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;hdr&#39;</span><span class="p">][</span><span class="s">&#39;nGas&#39;</span><span class="p">]</span>
        <span class="n">Av</span>   <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;Av&#39;</span><span class="p">]</span>
        <span class="n">gasT</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;gasT&#39;</span><span class="p">]</span>
        <span class="c">#abundances of species to be used later in getting the input needed by radex</span>
        <span class="n">xSpec</span>   <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;abun&#39;</span><span class="p">][</span> <span class="n">net</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="n">spec</span><span class="p">]</span><span class="o">.</span><span class="n">num</span> <span class="p">]</span>
        <span class="n">xColle</span>  <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;abun&#39;</span><span class="p">][</span> <span class="n">net</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="s">&#39;e-&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">num</span> <span class="p">]</span>
        <span class="n">xCollHP</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;abun&#39;</span><span class="p">][</span> <span class="n">net</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="s">&#39;H+&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">num</span> <span class="p">]</span>
        <span class="n">xCollH</span>  <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;abun&#39;</span><span class="p">][</span> <span class="n">net</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="s">&#39;H&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">num</span> <span class="p">]</span>
        <span class="n">xCollHe</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;abun&#39;</span><span class="p">][</span> <span class="n">net</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="s">&#39;He&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">num</span> <span class="p">]</span>
        <span class="n">xCollH2</span> <span class="o">=</span> <span class="n">m</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;abun&#39;</span><span class="p">][</span> <span class="n">net</span><span class="o">.</span><span class="n">species</span><span class="p">[</span><span class="s">&#39;H2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">num</span> <span class="p">]</span>

        <span class="c">#getting the indicies of the slab which have xH2 greater than xMin</span>
        <span class="n">inds</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">nonzero</span><span class="p">(</span> <span class="n">xCollH2</span>  <span class="o">&gt;</span> <span class="n">xMin</span>  <span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">inds</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>                
            <span class="k">return</span> <span class="p">(</span><span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">,</span> <span class="bp">None</span><span class="p">)</span>
        
        <span class="c"># assigning the thickness of the last slab to the one before the last one</span>
        <span class="n">dx</span>    <span class="o">=</span> <span class="n">getSlabThicknessFromAv</span><span class="p">(</span><span class="n">Av</span><span class="p">,</span> <span class="n">nGas</span><span class="p">,</span> <span class="n">Z</span><span class="p">)</span>
        <span class="n">dxNew</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span><span class="n">dx</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span> <span class="p">)</span>
        <span class="n">dxNew</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">dx</span>
        <span class="n">dxNew</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>   <span class="o">=</span> <span class="n">dx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">dx</span> <span class="o">=</span> <span class="n">dxNew</span>
        
        <span class="c"># selecting the slabs which are usefull</span>
        <span class="n">Av</span>    <span class="o">=</span> <span class="n">Av</span><span class="p">[</span><span class="n">inds</span><span class="p">]</span>
        <span class="n">dx</span>    <span class="o">=</span> <span class="n">dx</span><span class="p">[</span><span class="n">inds</span><span class="p">]</span>
        <span class="n">xSpec</span> <span class="o">=</span> <span class="n">xSpec</span><span class="p">[</span><span class="n">inds</span><span class="p">]</span>
        <span class="n">gasT</span>  <span class="o">=</span> <span class="n">gasT</span><span class="p">[</span><span class="n">inds</span><span class="p">]</span>
        <span class="n">xColle</span>  <span class="o">=</span> <span class="n">xColle</span><span class="p">[</span><span class="n">inds</span><span class="p">]</span>
        <span class="n">xCollHP</span> <span class="o">=</span> <span class="n">xCollHP</span><span class="p">[</span><span class="n">inds</span><span class="p">]</span>
        <span class="n">xCollH</span>  <span class="o">=</span> <span class="n">xCollH</span><span class="p">[</span><span class="n">inds</span><span class="p">]</span>
        <span class="n">xCollHe</span> <span class="o">=</span> <span class="n">xCollHe</span><span class="p">[</span><span class="n">inds</span><span class="p">]</span>
        <span class="n">xCollH2</span> <span class="o">=</span> <span class="n">xCollH2</span><span class="p">[</span><span class="n">inds</span><span class="p">]</span>

        <span class="c"># calculating the means</span>
        <span class="n">nSpec</span>    <span class="o">=</span> <span class="n">xSpec</span> <span class="o">*</span> <span class="n">nGas</span>
        <span class="n">nColle</span>   <span class="o">=</span> <span class="n">xColle</span> <span class="o">*</span> <span class="n">nGas</span>
        <span class="n">nCollHP</span>  <span class="o">=</span> <span class="n">xCollHP</span> <span class="o">*</span> <span class="n">nGas</span>
        <span class="n">nCollH</span>   <span class="o">=</span> <span class="n">xCollH</span> <span class="o">*</span> <span class="n">nGas</span>
        <span class="n">nCollHe</span>  <span class="o">=</span> <span class="n">xCollHe</span> <span class="o">*</span> <span class="n">nGas</span>
        <span class="n">nCollH2</span>  <span class="o">=</span> <span class="n">xCollH2</span> <span class="o">*</span> <span class="n">nGas</span>
        
        <span class="n">NSpec</span>     <span class="o">=</span> <span class="n">nSpec</span> <span class="o">*</span> <span class="n">dx</span>
        <span class="n">N_specLVG</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">NSpec</span><span class="p">)</span>

        <span class="n">TMean</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span> <span class="n">NSpec</span><span class="o">*</span><span class="n">gasT</span>    <span class="p">)</span> <span class="o">/</span> <span class="n">N_specLVG</span>
        <span class="n">nColleMean</span>  <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span> <span class="n">NSpec</span><span class="o">*</span><span class="n">nColle</span>  <span class="p">)</span> <span class="o">/</span> <span class="n">N_specLVG</span>
        <span class="n">nCollHPMean</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span> <span class="n">NSpec</span><span class="o">*</span><span class="n">nCollHP</span> <span class="p">)</span> <span class="o">/</span> <span class="n">N_specLVG</span>
        <span class="n">nCollHMean</span>  <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span> <span class="n">NSpec</span><span class="o">*</span><span class="n">nCollH</span>  <span class="p">)</span> <span class="o">/</span> <span class="n">N_specLVG</span>
        <span class="n">nCollHeMean</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span> <span class="n">NSpec</span><span class="o">*</span><span class="n">nCollHe</span> <span class="p">)</span> <span class="o">/</span> <span class="n">N_specLVG</span>
        <span class="n">nCollH2Mean</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span> <span class="n">NSpec</span><span class="o">*</span><span class="n">nCollH2</span> <span class="p">)</span> <span class="o">/</span> <span class="n">N_specLVG</span>
        
        <span class="n">nDenseColl</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;e-&#39;</span><span class="p">:</span> <span class="n">nColleMean</span> <span class="p">,</span>
                      <span class="s">&#39;H+&#39;</span><span class="p">:</span> <span class="n">nCollHPMean</span><span class="p">,</span>
                      <span class="s">&#39;H&#39;</span> <span class="p">:</span> <span class="n">nCollHMean</span> <span class="p">,</span>
                      <span class="s">&#39;He&#39;</span><span class="p">:</span> <span class="n">nCollHeMean</span><span class="p">,</span>
                      <span class="s">&#39;H2&#39;</span><span class="p">:</span> <span class="n">nCollH2Mean</span><span class="p">}</span>
        
        <span class="k">return</span> <span class="p">(</span>
                <span class="n">TMean</span><span class="p">,</span> 
                <span class="n">nDenseColl</span><span class="p">,</span>
                <span class="n">N_specLVG</span>
                <span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">plotMeshGeometry</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="n">fig</span> <span class="o">=</span> <span class="n">pylab</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">axs</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])</span>
        
        <span class="c">#Av = self.data[&#39;state&#39;][&#39;Av&#39;]</span>
        <span class="n">AvMax</span>  <span class="o">=</span> <span class="mf">30.0</span>
        <span class="n">dAvMin</span> <span class="o">=</span> <span class="mf">0.001</span>
        
        <span class="n">Av</span> <span class="o">=</span> <span class="mf">0.0</span>
        
        <span class="k">print</span> <span class="n">Av</span>
        
        <span class="n">dAv</span> <span class="o">=</span> <span class="n">dAvMin</span>
        
        <span class="k">while</span> <span class="n">Av</span> <span class="o">&lt;=</span> <span class="n">AvMax</span> <span class="o">+</span> <span class="mf">1e-10</span><span class="p">:</span>
            
            <span class="n">Av</span> <span class="o">+=</span> <span class="n">dAv</span>
             
            <span class="k">if</span> <span class="n">Av</span> <span class="o">&lt;</span> <span class="mf">1.0</span><span class="p">:</span>
                <span class="n">dAv</span> <span class="o">=</span> <span class="mf">10.0</span><span class="o">**</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Av</span><span class="p">)))</span>
                
            <span class="k">print</span> <span class="n">Av</span>
                

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        while dAv &lt; 1.0:</span>
<span class="sd">            </span>
<span class="sd">            </span>
<span class="sd">        Av = [dAv]</span>
<span class="sd">        </span>
<span class="sd">        Av = numpy.arange(31)</span>
<span class="sd">        for i in numpy.arange(30):</span>
<span class="sd">            if i &gt; 0 and i &lt;= 10: </span>
<span class="sd">                Av[i] = numpy.float64(i)/100</span>
<span class="sd">            if i &gt; 10 and i &lt;= 20:</span>
<span class="sd">                Av[i] = numpy.float64(i)/10</span>
<span class="sd">            if i &lt;= 10: </span>
<span class="sd">                Av[i] = numpy.float64(i)/100</span>
<span class="sd">            </span>
<span class="sd">            </span>
<span class="sd">        y  = numpy.ones(Av.shape)</span>
<span class="sd">        #asdasd</span>
<span class="sd">        axs.semilogx(Av, y, &#39;r&#39;)</span>
<span class="sd">        axs.semilogx(Av, y, &#39;ro&#39;)</span>

<span class="sd">        axs.set_ylim( ymin=0, ymax=2)</span>
<span class="sd">        axs.set_xlim( xmin=0.01, xmax=10)</span>
<span class="sd">        #axs.xaxis.set_scale(&#39;log&#39;)</span>
<span class="sd">        pylab.show()</span>
<span class="sd">        &quot;&quot;&quot;</span>
    
    <span class="k">def</span> <span class="nf">set_chemNet</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">chemNet</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">chemNet</span> <span class="o">=</span> <span class="n">chemNet</span>
    <span class="k">def</span> <span class="nf">set_metallicity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">metallicity</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metallicity</span> <span class="o">=</span> <span class="n">metallicity</span>
    
<div class="viewcode-block" id="mesh.compute_dx"><a class="viewcode-back" href="../index.html#mesh.mesh.compute_dx">[docs]</a>    <span class="k">def</span> <span class="nf">compute_dx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;computes and returns the thickness of the slabs for this mesh using self.data.</span>
<span class="sd">        </span>
<span class="sd">           :warning: do some extensive tests for this.</span>
<span class="sd">           :warning: the thickness of the last slab is set to be equal to the one before it. </span>
<span class="sd">               This is a good apporximation. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">nDense_m</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;hdr&#39;</span><span class="p">][</span><span class="s">&#39;nGas&#39;</span><span class="p">]</span> 
        <span class="n">Av_m</span>     <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;state&#39;</span><span class="p">][</span><span class="s">&#39;Av&#39;</span><span class="p">]</span>

        <span class="c"># setting the thickness of the last slab to the one before it</span>
        <span class="n">dx</span>          <span class="o">=</span>  <span class="n">getSlabThicknessFromAv</span><span class="p">(</span><span class="n">Av_m</span><span class="p">,</span> <span class="n">nDense_m</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">metallicity</span><span class="p">)</span>
        <span class="n">dxNew</span>       <span class="o">=</span>  <span class="n">numpy</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span> <span class="nb">len</span><span class="p">(</span><span class="n">dx</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">float64</span> <span class="p">)</span>
        <span class="n">dxNew</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span>  <span class="n">dx</span>
        <span class="n">dxNew</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>   <span class="o">=</span>  <span class="n">dx</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">dx</span>          <span class="o">=</span>  <span class="n">dxNew</span>

        <span class="k">return</span> <span class="n">dx</span>
        </div>
<div class="viewcode-block" id="mesh.compute_integrated_quantity"><a class="viewcode-back" href="../index.html#mesh.mesh.compute_integrated_quantity">[docs]</a>    <span class="k">def</span> <span class="nf">compute_integrated_quantity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">quantity</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;does the integral \sum_0^{N-1} f_i dx_i, where f_i is the quantity</span>
<span class="sd">        to be integrated upon and dx is the thickness of each slab&quot;&quot;&quot;</span>
        
        <span class="n">q</span> <span class="o">=</span> <span class="n">fetchNestedDtypeValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">quantity</span><span class="p">)</span>
        <span class="n">dxSlabs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">compute_dx</span><span class="p">()</span>
        
        <span class="k">return</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">q</span><span class="o">*</span><span class="n">dxSlabs</span><span class="p">)</span>        </div></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">ismcpak 0.0.0 documentation</a> &raquo;</li>
          <li><a href="index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Mher Kazandjian.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>