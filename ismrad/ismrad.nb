(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     53998,       1485]
NotebookOptionsPosition[     53116,       1456]
NotebookOutlinePosition[     53552,       1473]
CellTagsIndexPosition[     53509,       1470]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"number", " ", "of", " ", "levels"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nLevels", " ", "=", " ", "3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", "modules"}]}]}]}]}]}], " ", "that", " ", "define", 
     " ", "the", " ", "entries", " ", "of", " ", "the", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"matricies", "--"}], "--"}], "--"}], 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", "-"}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MColl", "[", 
      RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", "\[Equal]", "j"}], ",", "0", ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", ">", "j"}], ",", 
           RowBox[{"k", "[", 
            RowBox[{"i", ",", "j"}], "]"}], ",", 
           RowBox[{
            FractionBox[
             RowBox[{"g", "[", "j", "]"}], 
             RowBox[{"g", "[", "i", "]"}]], 
            RowBox[{"k", "[", 
             RowBox[{"j", ",", "i"}], "]"}], "*", 
            RowBox[{"Exp", "[", 
             RowBox[{
              RowBox[{"-", 
               RowBox[{"en", "[", 
                RowBox[{"j", ",", "i"}], "]"}]}], "/", 
              RowBox[{"(", 
               RowBox[{"KB", "*", "Tkin"}], ")"}]}], "]"}]}]}], "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MEM", "[", 
      RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", ">", "j"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"ng", "[", 
             RowBox[{"i", ",", "j"}], "]"}]}], ")"}], "*", 
          RowBox[{"A", "[", 
           RowBox[{"i", ",", "j"}], "]"}]}], ",", "0"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"MABS", "[", 
      RowBox[{"i_", ",", "j_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", ">", "j"}], ",", 
         RowBox[{
          FractionBox[
           RowBox[{"g", "[", "i", "]"}], 
           RowBox[{"g", "[", "j", "]"}]], 
          RowBox[{"ng", "[", 
           RowBox[{"i", ",", "j"}], "]"}], "*", 
          RowBox[{"A", "[", 
           RowBox[{"i", ",", "j"}], "]"}]}], ",", "0"}], "]"}]}], 
      "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"--", 
     RowBox[{"--", 
      RowBox[{"--", 
       RowBox[{"--", 
        RowBox[{"--", 
         RowBox[{"--", 
          RowBox[{"--", 
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", 
              RowBox[{"--", 
               RowBox[{"--", 
                RowBox[{"-", 
                 RowBox[{"-", 
                  RowBox[{"--", 
                   RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{"--", 
                    RowBox[{
                    "--", "-"}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}\
]}]}]}]}]}]}]}]}]}]}]}]}]}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nt", "=", 
     RowBox[{"nLevels", "-", "1"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nCol", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"n", "[", "i", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "nt"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"nCol", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"EM", "=", 
     RowBox[{"Table", "[", 
      RowBox[{"1", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "nt"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", "nt"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KM", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"MColl", "[", 
        RowBox[{"i", ",", "j"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "nt"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", "nt"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"KM", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"APM", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"MEM", "[", 
        RowBox[{"i", ",", "j"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "nt"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", "nt"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"APM", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ABSM", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"MABS", "[", 
        RowBox[{"i", ",", "j"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "nt"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", "nt"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ABSM", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "offidagonal", " ", "components", " ", "of", " ", "the", " ", "matrix"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"F", " ", "=", " ", 
     RowBox[{
      RowBox[{"nc", "*", "KM"}], "+", "APM", "+", 
      RowBox[{"Transpose", "[", "ABSM", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"offDiag", "=", 
     RowBox[{"Transpose", "[", "F", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"offDiag", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"getting", " ", "the", " ", "diagonal", " ", "entries"}], " ", 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"diag", "=", 
     RowBox[{"(", 
      RowBox[{"F", ".", "EM"}], ")"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"diag", "=", 
     RowBox[{"diag", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"diag", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"i", "\[Equal]", "j"}], ",", 
         RowBox[{"diag", "[", 
          RowBox[{"[", 
           RowBox[{"i", "+", "1"}], "]"}], "]"}], ",", "0"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", "nt"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"j", ",", "0", ",", "nt"}], "}"}]}], "]"}]}], ";", 
    RowBox[{"(*", 
     RowBox[{"applying", " ", "the", " ", "operator", " ", "D"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{"diag", "//", "MatrixForm"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"the", " ", "full", " ", "matrix"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"full", " ", "=", " ", 
     RowBox[{
      RowBox[{"-", " ", "diag"}], " ", "+", " ", "offDiag"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"full", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"(*", " ", "dndt", " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dndt", " ", "=", " ", 
     RowBox[{"full", ".", "nCol"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"dndt", "//", "MatrixForm"}], "\[IndentingNewLine]", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"Det", "[", "full", "]"}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"Total", "[", "dndt", "]"}], "]"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "explicit", " ", "numerical", " ", "example", " ", "for", " ", "a", " ", 
     "3", " ", "level", " ", "system"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pnc", " ", "=", " ", "1.5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pTkin", "=", "15.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pTcmb", "=", "2.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pkb", "=", "1.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ph", "=", "2.0"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"g0", "=", "1.0"}], ";", 
    RowBox[{"g1", "=", "3.0"}], ";", 
    RowBox[{"g2", "=", "5.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"e0", "=", "0.0"}], ";", " ", 
    RowBox[{"e1", "=", "4.5"}], ";", 
    RowBox[{"e2", "=", "7.5"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A00", "=", "0.0"}], ";", " ", 
    RowBox[{"A01", "=", "0.0"}], ";", 
    RowBox[{"A02", "=", "0.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A10", "=", "0.5"}], ";", " ", 
    RowBox[{"A11", "=", "0.0"}], ";", " ", 
    RowBox[{"A12", "=", "0.0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"A20", "=", "0.2"}], ";", " ", 
    RowBox[{"A21", "=", "0.15"}], ";", " ", 
    RowBox[{"A22", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"k10", "=", "6.0"}], ";", " ", 
    RowBox[{"k20", "=", "8.0"}], ";", 
    RowBox[{"k21", "=", "2.4"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"en10", "=", 
     RowBox[{"e1", "-", "e0"}]}], ";", " ", 
    RowBox[{"en20", "=", 
     RowBox[{"e2", "-", "e0"}]}], ";", " ", 
    RowBox[{"en21", "=", 
     RowBox[{"e2", "-", "e1"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ng10", "=", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"en10", "/", 
         RowBox[{"(", 
          RowBox[{"pkb", "*", "pTcmb"}], ")"}]}], "]"}], "-", "1"}]]}], ";", 
    RowBox[{"ng20", "=", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"en20", "/", 
         RowBox[{"(", 
          RowBox[{"pkb", "*", "pTcmb"}], ")"}]}], "]"}], "-", "1"}]]}], ";", 
    RowBox[{"ng21", "=", 
     FractionBox["1", 
      RowBox[{
       RowBox[{"Exp", "[", 
        RowBox[{"en21", "/", 
         RowBox[{"(", 
          RowBox[{"pkb", "*", "pTcmb"}], ")"}]}], "]"}], "-", "1"}]]}], ";"}],
    "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"dndt", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "=", 
     RowBox[{
      RowBox[{"n", "[", "0", "]"}], "+", 
      RowBox[{"n", "[", "1", "]"}], "+", 
      RowBox[{"n", "[", "2", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"sol", "=", 
     RowBox[{"Solve", "[", " ", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"dndt", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"i", "\[Equal]", "1"}], ",", "1", ",", "0"}], "]"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "3"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"n", "[", "0", "]"}], ",", 
         RowBox[{"n", "[", "1", "]"}], ",", 
         RowBox[{"n", "[", "2", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"numSol", " ", "=", " ", 
    RowBox[{"sol", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"nc", "\[Rule]", "pnc"}], ",", " ", 
       RowBox[{"Tkin", "\[Rule]", "pTkin"}], ",", 
       RowBox[{"KB", "\[Rule]", "pkb"}], ",", "\[IndentingNewLine]", 
       "                                    ", 
       RowBox[{
        RowBox[{"g", "[", "0", "]"}], "\[Rule]", "g0"}], ",", 
       RowBox[{
        RowBox[{"g", "[", "1", "]"}], "\[Rule]", "g1"}], ",", 
       RowBox[{
        RowBox[{"g", "[", "2", "]"}], "\[Rule]", "g2"}], ",", 
       "\[IndentingNewLine]", "                                    ", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"1", ",", "0"}], "]"}], "\[Rule]", "A10"}], ",", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"2", ",", "0"}], "]"}], "\[Rule]", "A20"}], ",", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"2", ",", "1"}], "]"}], "\[Rule]", "A21"}], ",", 
       "\[IndentingNewLine]", "                                    ", 
       RowBox[{
        RowBox[{"k", "[", 
         RowBox[{"1", ",", "0"}], "]"}], "\[Rule]", "k10"}], ",", 
       RowBox[{
        RowBox[{"k", "[", 
         RowBox[{"2", ",", "0"}], "]"}], "\[Rule]", "k20"}], ",", 
       RowBox[{
        RowBox[{"k", "[", 
         RowBox[{"2", ",", "1"}], "]"}], "\[Rule]", "k21"}], ",", 
       "\[IndentingNewLine]", "                                   ", 
       RowBox[{
        RowBox[{"en", "[", 
         RowBox[{"1", ",", "0"}], "]"}], "\[Rule]", "en10"}], ",", 
       RowBox[{
        RowBox[{"en", "[", 
         RowBox[{"2", ",", "0"}], "]"}], "\[Rule]", "en20"}], ",", 
       RowBox[{
        RowBox[{"en", "[", 
         RowBox[{"2", ",", "1"}], "]"}], "\[Rule]", "en21"}], ",", 
       "\[IndentingNewLine]", "\t\t\t     ", 
       RowBox[{
        RowBox[{"ng", "[", 
         RowBox[{"1", ",", "0"}], "]"}], "\[Rule]", "ng10"}], ",", 
       RowBox[{
        RowBox[{"ng", "[", 
         RowBox[{"2", ",", "0"}], "]"}], "\[Rule]", "ng20"}], ",", 
       RowBox[{
        RowBox[{"ng", "[", 
         RowBox[{"2", ",", "1"}], "]"}], "\[Rule]", "ng21"}]}], "}"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "[", 
     RowBox[{"\"\<the sum of the population densities = \>\"", ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"numSol", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"numSol", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}], "+", 
       RowBox[{
        RowBox[{
         RowBox[{"numSol", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], "[", 
        RowBox[{"[", "2", "]"}], "]"}]}]}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.56408751647279*^9, 3.564087577832645*^9}, {
   3.564087610176367*^9, 3.564087685174263*^9}, {3.5640877335707684`*^9, 
   3.564087735376316*^9}, {3.564087812779779*^9, 3.564087813649591*^9}, {
   3.56408784495632*^9, 3.5640881526905317`*^9}, {3.5640883255841017`*^9, 
   3.564088349650069*^9}, {3.564088484265654*^9, 3.564088484444993*^9}, {
   3.564088544526222*^9, 3.564088560222568*^9}, {3.564088608582024*^9, 
   3.564088788786892*^9}, {3.56408886172437*^9, 3.564089000824242*^9}, {
   3.5640942267937803`*^9, 3.56409422707577*^9}, {3.564094492461595*^9, 
   3.564094493167803*^9}, {3.564094613944162*^9, 3.5640946740282907`*^9}, 
   3.564099530599964*^9, {3.564103732680428*^9, 3.564103833394908*^9}, {
   3.564104568448195*^9, 3.564104646373864*^9}, {3.564104686098988*^9, 
   3.564104686973854*^9}, {3.564104734579323*^9, 3.564104826691581*^9}, 
   3.564153232560667*^9, {3.56415977733771*^9, 3.564159803022789*^9}, {
   3.56415984004704*^9, 3.564159841557423*^9}, {3.564160243177772*^9, 
   3.564160252431129*^9}, {3.564160491061055*^9, 3.564160587961502*^9}, {
   3.564160628685277*^9, 3.564160644927588*^9}, {3.56416089587362*^9, 
   3.564160905325715*^9}, 3.5641613141320972`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"n", "[", "0", "]"}]},
      {
       RowBox[{"n", "[", "1", "]"}]},
      {
       RowBox[{"n", "[", "2", "]"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.564103894621984*^9, 3.564103930232046*^9, {3.564104555831513*^9, 
   3.564104598594522*^9}, 3.564104647426385*^9, 3.5641046877449617`*^9, {
   3.564104782549036*^9, 3.564104827162631*^9}, 3.564153233309395*^9, 
   3.5641575605653687`*^9, 3.564157805806521*^9, {3.564159781601679*^9, 
   3.564159842405517*^9}, {3.564160236359441*^9, 3.5641602531609507`*^9}, 
   3.564160473746244*^9, {3.56416056787719*^9, 3.564160589260504*^9}, 
   3.5641606457018948`*^9, 3.564160912072307*^9, 3.5641609623912067`*^9, 
   3.5641613186155357`*^9, 3.564161554038928*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"en", "[", 
            RowBox[{"1", ",", "0"}], "]"}], 
           RowBox[{"KB", " ", "Tkin"}]]}]], " ", 
        RowBox[{"g", "[", "1", "]"}], " ", 
        RowBox[{"k", "[", 
         RowBox[{"1", ",", "0"}], "]"}]}], 
       RowBox[{"g", "[", "0", "]"}]], 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"en", "[", 
            RowBox[{"2", ",", "0"}], "]"}], 
           RowBox[{"KB", " ", "Tkin"}]]}]], " ", 
        RowBox[{"g", "[", "2", "]"}], " ", 
        RowBox[{"k", "[", 
         RowBox[{"2", ",", "0"}], "]"}]}], 
       RowBox[{"g", "[", "0", "]"}]]},
     {
      RowBox[{"k", "[", 
       RowBox[{"1", ",", "0"}], "]"}], "0", 
      FractionBox[
       RowBox[{
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{"en", "[", 
            RowBox[{"2", ",", "1"}], "]"}], 
           RowBox[{"KB", " ", "Tkin"}]]}]], " ", 
        RowBox[{"g", "[", "2", "]"}], " ", 
        RowBox[{"k", "[", 
         RowBox[{"2", ",", "1"}], "]"}]}], 
       RowBox[{"g", "[", "1", "]"}]]},
     {
      RowBox[{"k", "[", 
       RowBox[{"2", ",", "0"}], "]"}], 
      RowBox[{"k", "[", 
       RowBox[{"2", ",", "1"}], "]"}], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.564103894621984*^9, 3.564103930232046*^9, {3.564104555831513*^9, 
   3.564104598594522*^9}, 3.564104647426385*^9, 3.5641046877449617`*^9, {
   3.564104782549036*^9, 3.564104827162631*^9}, 3.564153233309395*^9, 
   3.5641575605653687`*^9, 3.564157805806521*^9, {3.564159781601679*^9, 
   3.564159842405517*^9}, {3.564160236359441*^9, 3.5641602531609507`*^9}, 
   3.564160473746244*^9, {3.56416056787719*^9, 3.564160589260504*^9}, 
   3.5641606457018948`*^9, 3.564160912072307*^9, 3.5641609623912067`*^9, 
   3.5641613186155357`*^9, 3.564161554048512*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0"},
     {
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"1", ",", "0"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"ng", "[", 
          RowBox[{"1", ",", "0"}], "]"}]}], ")"}]}], "0", "0"},
     {
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"2", ",", "0"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"ng", "[", 
          RowBox[{"2", ",", "0"}], "]"}]}], ")"}]}], 
      RowBox[{
       RowBox[{"A", "[", 
        RowBox[{"2", ",", "1"}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"ng", "[", 
          RowBox[{"2", ",", "1"}], "]"}]}], ")"}]}], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.564103894621984*^9, 3.564103930232046*^9, {3.564104555831513*^9, 
   3.564104598594522*^9}, 3.564104647426385*^9, 3.5641046877449617`*^9, {
   3.564104782549036*^9, 3.564104827162631*^9}, 3.564153233309395*^9, 
   3.5641575605653687`*^9, 3.564157805806521*^9, {3.564159781601679*^9, 
   3.564159842405517*^9}, {3.564160236359441*^9, 3.5641602531609507`*^9}, 
   3.564160473746244*^9, {3.56416056787719*^9, 3.564160589260504*^9}, 
   3.5641606457018948`*^9, 3.564160912072307*^9, 3.5641609623912067`*^9, 
   3.5641613186155357`*^9, 3.5641615540671673`*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0"},
     {
      FractionBox[
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"1", ",", "0"}], "]"}], " ", 
        RowBox[{"g", "[", "1", "]"}], " ", 
        RowBox[{"ng", "[", 
         RowBox[{"1", ",", "0"}], "]"}]}], 
       RowBox[{"g", "[", "0", "]"}]], "0", "0"},
     {
      FractionBox[
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"2", ",", "0"}], "]"}], " ", 
        RowBox[{"g", "[", "2", "]"}], " ", 
        RowBox[{"ng", "[", 
         RowBox[{"2", ",", "0"}], "]"}]}], 
       RowBox[{"g", "[", "0", "]"}]], 
      FractionBox[
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"2", ",", "1"}], "]"}], " ", 
        RowBox[{"g", "[", "2", "]"}], " ", 
        RowBox[{"ng", "[", 
         RowBox[{"2", ",", "1"}], "]"}]}], 
       RowBox[{"g", "[", "1", "]"}]], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.564103894621984*^9, 3.564103930232046*^9, {3.564104555831513*^9, 
   3.564104598594522*^9}, 3.564104647426385*^9, 3.5641046877449617`*^9, {
   3.564104782549036*^9, 3.564104827162631*^9}, 3.564153233309395*^9, 
   3.5641575605653687`*^9, 3.564157805806521*^9, {3.564159781601679*^9, 
   3.564159842405517*^9}, {3.564160236359441*^9, 3.5641602531609507`*^9}, 
   3.564160473746244*^9, {3.56416056787719*^9, 3.564160589260504*^9}, 
   3.5641606457018948`*^9, 3.564160912072307*^9, 3.5641609623912067`*^9, 
   3.5641613186155357`*^9, 3.564161554079563*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{
       RowBox[{"nc", " ", 
        RowBox[{"k", "[", 
         RowBox[{"1", ",", "0"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"1", ",", "0"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"ng", "[", 
           RowBox[{"1", ",", "0"}], "]"}]}], ")"}]}]}], 
      RowBox[{
       RowBox[{"nc", " ", 
        RowBox[{"k", "[", 
         RowBox[{"2", ",", "0"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"2", ",", "0"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"ng", "[", 
           RowBox[{"2", ",", "0"}], "]"}]}], ")"}]}]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"en", "[", 
             RowBox[{"1", ",", "0"}], "]"}], 
            RowBox[{"KB", " ", "Tkin"}]]}]], " ", "nc", " ", 
         RowBox[{"g", "[", "1", "]"}], " ", 
         RowBox[{"k", "[", 
          RowBox[{"1", ",", "0"}], "]"}]}], 
        RowBox[{"g", "[", "0", "]"}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"1", ",", "0"}], "]"}], " ", 
         RowBox[{"g", "[", "1", "]"}], " ", 
         RowBox[{"ng", "[", 
          RowBox[{"1", ",", "0"}], "]"}]}], 
        RowBox[{"g", "[", "0", "]"}]]}], "0", 
      RowBox[{
       RowBox[{"nc", " ", 
        RowBox[{"k", "[", 
         RowBox[{"2", ",", "1"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"2", ",", "1"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"ng", "[", 
           RowBox[{"2", ",", "1"}], "]"}]}], ")"}]}]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"en", "[", 
             RowBox[{"2", ",", "0"}], "]"}], 
            RowBox[{"KB", " ", "Tkin"}]]}]], " ", "nc", " ", 
         RowBox[{"g", "[", "2", "]"}], " ", 
         RowBox[{"k", "[", 
          RowBox[{"2", ",", "0"}], "]"}]}], 
        RowBox[{"g", "[", "0", "]"}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"2", ",", "0"}], "]"}], " ", 
         RowBox[{"g", "[", "2", "]"}], " ", 
         RowBox[{"ng", "[", 
          RowBox[{"2", ",", "0"}], "]"}]}], 
        RowBox[{"g", "[", "0", "]"}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"en", "[", 
             RowBox[{"2", ",", "1"}], "]"}], 
            RowBox[{"KB", " ", "Tkin"}]]}]], " ", "nc", " ", 
         RowBox[{"g", "[", "2", "]"}], " ", 
         RowBox[{"k", "[", 
          RowBox[{"2", ",", "1"}], "]"}]}], 
        RowBox[{"g", "[", "1", "]"}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"2", ",", "1"}], "]"}], " ", 
         RowBox[{"g", "[", "2", "]"}], " ", 
         RowBox[{"ng", "[", 
          RowBox[{"2", ",", "1"}], "]"}]}], 
        RowBox[{"g", "[", "1", "]"}]]}], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.564103894621984*^9, 3.564103930232046*^9, {3.564104555831513*^9, 
   3.564104598594522*^9}, 3.564104647426385*^9, 3.5641046877449617`*^9, {
   3.564104782549036*^9, 3.564104827162631*^9}, 3.564153233309395*^9, 
   3.5641575605653687`*^9, 3.564157805806521*^9, {3.564159781601679*^9, 
   3.564159842405517*^9}, {3.564160236359441*^9, 3.5641602531609507`*^9}, 
   3.564160473746244*^9, {3.56416056787719*^9, 3.564160589260504*^9}, 
   3.5641606457018948`*^9, 3.564160912072307*^9, 3.5641609623912067`*^9, 
   3.5641613186155357`*^9, 3.564161554096664*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"en", "[", 
             RowBox[{"1", ",", "0"}], "]"}], 
            RowBox[{"KB", " ", "Tkin"}]]}]], " ", "nc", " ", 
         RowBox[{"g", "[", "1", "]"}], " ", 
         RowBox[{"k", "[", 
          RowBox[{"1", ",", "0"}], "]"}]}], 
        RowBox[{"g", "[", "0", "]"}]], "+", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"en", "[", 
             RowBox[{"2", ",", "0"}], "]"}], 
            RowBox[{"KB", " ", "Tkin"}]]}]], " ", "nc", " ", 
         RowBox[{"g", "[", "2", "]"}], " ", 
         RowBox[{"k", "[", 
          RowBox[{"2", ",", "0"}], "]"}]}], 
        RowBox[{"g", "[", "0", "]"}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"1", ",", "0"}], "]"}], " ", 
         RowBox[{"g", "[", "1", "]"}], " ", 
         RowBox[{"ng", "[", 
          RowBox[{"1", ",", "0"}], "]"}]}], 
        RowBox[{"g", "[", "0", "]"}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"2", ",", "0"}], "]"}], " ", 
         RowBox[{"g", "[", "2", "]"}], " ", 
         RowBox[{"ng", "[", 
          RowBox[{"2", ",", "0"}], "]"}]}], 
        RowBox[{"g", "[", "0", "]"}]]}], "0", "0"},
     {"0", 
      RowBox[{
       RowBox[{"nc", " ", 
        RowBox[{"k", "[", 
         RowBox[{"1", ",", "0"}], "]"}]}], "+", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"en", "[", 
             RowBox[{"2", ",", "1"}], "]"}], 
            RowBox[{"KB", " ", "Tkin"}]]}]], " ", "nc", " ", 
         RowBox[{"g", "[", "2", "]"}], " ", 
         RowBox[{"k", "[", 
          RowBox[{"2", ",", "1"}], "]"}]}], 
        RowBox[{"g", "[", "1", "]"}]], "+", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"1", ",", "0"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"ng", "[", 
           RowBox[{"1", ",", "0"}], "]"}]}], ")"}]}], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"2", ",", "1"}], "]"}], " ", 
         RowBox[{"g", "[", "2", "]"}], " ", 
         RowBox[{"ng", "[", 
          RowBox[{"2", ",", "1"}], "]"}]}], 
        RowBox[{"g", "[", "1", "]"}]]}], "0"},
     {"0", "0", 
      RowBox[{
       RowBox[{"nc", " ", 
        RowBox[{"k", "[", 
         RowBox[{"2", ",", "0"}], "]"}]}], "+", 
       RowBox[{"nc", " ", 
        RowBox[{"k", "[", 
         RowBox[{"2", ",", "1"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"2", ",", "0"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"ng", "[", 
           RowBox[{"2", ",", "0"}], "]"}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"2", ",", "1"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"ng", "[", 
           RowBox[{"2", ",", "1"}], "]"}]}], ")"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.564103894621984*^9, 3.564103930232046*^9, {3.564104555831513*^9, 
   3.564104598594522*^9}, 3.564104647426385*^9, 3.5641046877449617`*^9, {
   3.564104782549036*^9, 3.564104827162631*^9}, 3.564153233309395*^9, 
   3.5641575605653687`*^9, 3.564157805806521*^9, {3.564159781601679*^9, 
   3.564159842405517*^9}, {3.564160236359441*^9, 3.5641602531609507`*^9}, 
   3.564160473746244*^9, {3.56416056787719*^9, 3.564160589260504*^9}, 
   3.5641606457018948`*^9, 3.564160912072307*^9, 3.5641609623912067`*^9, 
   3.5641613186155357`*^9, 3.564161554118888*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          SuperscriptBox["\[ExponentialE]", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{"en", "[", 
              RowBox[{"1", ",", "0"}], "]"}], 
             RowBox[{"KB", " ", "Tkin"}]]}]], " ", "nc", " ", 
          RowBox[{"g", "[", "1", "]"}], " ", 
          RowBox[{"k", "[", 
           RowBox[{"1", ",", "0"}], "]"}]}], 
         RowBox[{"g", "[", "0", "]"}]]}], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"en", "[", 
             RowBox[{"2", ",", "0"}], "]"}], 
            RowBox[{"KB", " ", "Tkin"}]]}]], " ", "nc", " ", 
         RowBox[{"g", "[", "2", "]"}], " ", 
         RowBox[{"k", "[", 
          RowBox[{"2", ",", "0"}], "]"}]}], 
        RowBox[{"g", "[", "0", "]"}]], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"1", ",", "0"}], "]"}], " ", 
         RowBox[{"g", "[", "1", "]"}], " ", 
         RowBox[{"ng", "[", 
          RowBox[{"1", ",", "0"}], "]"}]}], 
        RowBox[{"g", "[", "0", "]"}]], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"2", ",", "0"}], "]"}], " ", 
         RowBox[{"g", "[", "2", "]"}], " ", 
         RowBox[{"ng", "[", 
          RowBox[{"2", ",", "0"}], "]"}]}], 
        RowBox[{"g", "[", "0", "]"}]]}], 
      RowBox[{
       RowBox[{"nc", " ", 
        RowBox[{"k", "[", 
         RowBox[{"1", ",", "0"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"1", ",", "0"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"ng", "[", 
           RowBox[{"1", ",", "0"}], "]"}]}], ")"}]}]}], 
      RowBox[{
       RowBox[{"nc", " ", 
        RowBox[{"k", "[", 
         RowBox[{"2", ",", "0"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"2", ",", "0"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"ng", "[", 
           RowBox[{"2", ",", "0"}], "]"}]}], ")"}]}]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"en", "[", 
             RowBox[{"1", ",", "0"}], "]"}], 
            RowBox[{"KB", " ", "Tkin"}]]}]], " ", "nc", " ", 
         RowBox[{"g", "[", "1", "]"}], " ", 
         RowBox[{"k", "[", 
          RowBox[{"1", ",", "0"}], "]"}]}], 
        RowBox[{"g", "[", "0", "]"}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"1", ",", "0"}], "]"}], " ", 
         RowBox[{"g", "[", "1", "]"}], " ", 
         RowBox[{"ng", "[", 
          RowBox[{"1", ",", "0"}], "]"}]}], 
        RowBox[{"g", "[", "0", "]"}]]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "nc"}], " ", 
        RowBox[{"k", "[", 
         RowBox[{"1", ",", "0"}], "]"}]}], "-", 
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"en", "[", 
             RowBox[{"2", ",", "1"}], "]"}], 
            RowBox[{"KB", " ", "Tkin"}]]}]], " ", "nc", " ", 
         RowBox[{"g", "[", "2", "]"}], " ", 
         RowBox[{"k", "[", 
          RowBox[{"2", ",", "1"}], "]"}]}], 
        RowBox[{"g", "[", "1", "]"}]], "-", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"1", ",", "0"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"ng", "[", 
           RowBox[{"1", ",", "0"}], "]"}]}], ")"}]}], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"2", ",", "1"}], "]"}], " ", 
         RowBox[{"g", "[", "2", "]"}], " ", 
         RowBox[{"ng", "[", 
          RowBox[{"2", ",", "1"}], "]"}]}], 
        RowBox[{"g", "[", "1", "]"}]]}], 
      RowBox[{
       RowBox[{"nc", " ", 
        RowBox[{"k", "[", 
         RowBox[{"2", ",", "1"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"2", ",", "1"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"ng", "[", 
           RowBox[{"2", ",", "1"}], "]"}]}], ")"}]}]}]},
     {
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"en", "[", 
             RowBox[{"2", ",", "0"}], "]"}], 
            RowBox[{"KB", " ", "Tkin"}]]}]], " ", "nc", " ", 
         RowBox[{"g", "[", "2", "]"}], " ", 
         RowBox[{"k", "[", 
          RowBox[{"2", ",", "0"}], "]"}]}], 
        RowBox[{"g", "[", "0", "]"}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"2", ",", "0"}], "]"}], " ", 
         RowBox[{"g", "[", "2", "]"}], " ", 
         RowBox[{"ng", "[", 
          RowBox[{"2", ",", "0"}], "]"}]}], 
        RowBox[{"g", "[", "0", "]"}]]}], 
      RowBox[{
       FractionBox[
        RowBox[{
         SuperscriptBox["\[ExponentialE]", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{"en", "[", 
             RowBox[{"2", ",", "1"}], "]"}], 
            RowBox[{"KB", " ", "Tkin"}]]}]], " ", "nc", " ", 
         RowBox[{"g", "[", "2", "]"}], " ", 
         RowBox[{"k", "[", 
          RowBox[{"2", ",", "1"}], "]"}]}], 
        RowBox[{"g", "[", "1", "]"}]], "+", 
       FractionBox[
        RowBox[{
         RowBox[{"A", "[", 
          RowBox[{"2", ",", "1"}], "]"}], " ", 
         RowBox[{"g", "[", "2", "]"}], " ", 
         RowBox[{"ng", "[", 
          RowBox[{"2", ",", "1"}], "]"}]}], 
        RowBox[{"g", "[", "1", "]"}]]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", "nc"}], " ", 
        RowBox[{"k", "[", 
         RowBox[{"2", ",", "0"}], "]"}]}], "-", 
       RowBox[{"nc", " ", 
        RowBox[{"k", "[", 
         RowBox[{"2", ",", "1"}], "]"}]}], "-", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"2", ",", "0"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"ng", "[", 
           RowBox[{"2", ",", "0"}], "]"}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"A", "[", 
         RowBox[{"2", ",", "1"}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", 
          RowBox[{"ng", "[", 
           RowBox[{"2", ",", "1"}], "]"}]}], ")"}]}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.564103894621984*^9, 3.564103930232046*^9, {3.564104555831513*^9, 
   3.564104598594522*^9}, 3.564104647426385*^9, 3.5641046877449617`*^9, {
   3.564104782549036*^9, 3.564104827162631*^9}, 3.564153233309395*^9, 
   3.5641575605653687`*^9, 3.564157805806521*^9, {3.564159781601679*^9, 
   3.564159842405517*^9}, {3.564160236359441*^9, 3.5641602531609507`*^9}, 
   3.564160473746244*^9, {3.56416056787719*^9, 3.564160589260504*^9}, 
   3.5641606457018948`*^9, 3.564160912072307*^9, 3.5641609623912067`*^9, 
   3.5641613186155357`*^9, 3.564161554152339*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{
        RowBox[{
         RowBox[{"n", "[", "1", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"nc", " ", 
            RowBox[{"k", "[", 
             RowBox[{"1", ",", "0"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"A", "[", 
             RowBox[{"1", ",", "0"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"ng", "[", 
               RowBox[{"1", ",", "0"}], "]"}]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"n", "[", "0", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            FractionBox[
             RowBox[{
              SuperscriptBox["\[ExponentialE]", 
               RowBox[{"-", 
                FractionBox[
                 RowBox[{"en", "[", 
                  RowBox[{"1", ",", "0"}], "]"}], 
                 RowBox[{"KB", " ", "Tkin"}]]}]], " ", "nc", " ", 
              RowBox[{"g", "[", "1", "]"}], " ", 
              RowBox[{"k", "[", 
               RowBox[{"1", ",", "0"}], "]"}]}], 
             RowBox[{"g", "[", "0", "]"}]]}], "-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"-", 
               FractionBox[
                RowBox[{"en", "[", 
                 RowBox[{"2", ",", "0"}], "]"}], 
                RowBox[{"KB", " ", "Tkin"}]]}]], " ", "nc", " ", 
             RowBox[{"g", "[", "2", "]"}], " ", 
             RowBox[{"k", "[", 
              RowBox[{"2", ",", "0"}], "]"}]}], 
            RowBox[{"g", "[", "0", "]"}]], "-", 
           FractionBox[
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"1", ",", "0"}], "]"}], " ", 
             RowBox[{"g", "[", "1", "]"}], " ", 
             RowBox[{"ng", "[", 
              RowBox[{"1", ",", "0"}], "]"}]}], 
            RowBox[{"g", "[", "0", "]"}]], "-", 
           FractionBox[
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"2", ",", "0"}], "]"}], " ", 
             RowBox[{"g", "[", "2", "]"}], " ", 
             RowBox[{"ng", "[", 
              RowBox[{"2", ",", "0"}], "]"}]}], 
            RowBox[{"g", "[", "0", "]"}]]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"n", "[", "2", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"nc", " ", 
            RowBox[{"k", "[", 
             RowBox[{"2", ",", "0"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"A", "[", 
             RowBox[{"2", ",", "0"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"ng", "[", 
               RowBox[{"2", ",", "0"}], "]"}]}], ")"}]}]}], ")"}]}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"n", "[", "0", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"-", 
               FractionBox[
                RowBox[{"en", "[", 
                 RowBox[{"1", ",", "0"}], "]"}], 
                RowBox[{"KB", " ", "Tkin"}]]}]], " ", "nc", " ", 
             RowBox[{"g", "[", "1", "]"}], " ", 
             RowBox[{"k", "[", 
              RowBox[{"1", ",", "0"}], "]"}]}], 
            RowBox[{"g", "[", "0", "]"}]], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"1", ",", "0"}], "]"}], " ", 
             RowBox[{"g", "[", "1", "]"}], " ", 
             RowBox[{"ng", "[", 
              RowBox[{"1", ",", "0"}], "]"}]}], 
            RowBox[{"g", "[", "0", "]"}]]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"n", "[", "1", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "nc"}], " ", 
            RowBox[{"k", "[", 
             RowBox[{"1", ",", "0"}], "]"}]}], "-", 
           FractionBox[
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"-", 
               FractionBox[
                RowBox[{"en", "[", 
                 RowBox[{"2", ",", "1"}], "]"}], 
                RowBox[{"KB", " ", "Tkin"}]]}]], " ", "nc", " ", 
             RowBox[{"g", "[", "2", "]"}], " ", 
             RowBox[{"k", "[", 
              RowBox[{"2", ",", "1"}], "]"}]}], 
            RowBox[{"g", "[", "1", "]"}]], "-", 
           RowBox[{
            RowBox[{"A", "[", 
             RowBox[{"1", ",", "0"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"ng", "[", 
               RowBox[{"1", ",", "0"}], "]"}]}], ")"}]}], "-", 
           FractionBox[
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"2", ",", "1"}], "]"}], " ", 
             RowBox[{"g", "[", "2", "]"}], " ", 
             RowBox[{"ng", "[", 
              RowBox[{"2", ",", "1"}], "]"}]}], 
            RowBox[{"g", "[", "1", "]"}]]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"n", "[", "2", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"nc", " ", 
            RowBox[{"k", "[", 
             RowBox[{"2", ",", "1"}], "]"}]}], "+", 
           RowBox[{
            RowBox[{"A", "[", 
             RowBox[{"2", ",", "1"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"ng", "[", 
               RowBox[{"2", ",", "1"}], "]"}]}], ")"}]}]}], ")"}]}]}]},
      {
       RowBox[{
        RowBox[{
         RowBox[{"n", "[", "0", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"-", 
               FractionBox[
                RowBox[{"en", "[", 
                 RowBox[{"2", ",", "0"}], "]"}], 
                RowBox[{"KB", " ", "Tkin"}]]}]], " ", "nc", " ", 
             RowBox[{"g", "[", "2", "]"}], " ", 
             RowBox[{"k", "[", 
              RowBox[{"2", ",", "0"}], "]"}]}], 
            RowBox[{"g", "[", "0", "]"}]], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"2", ",", "0"}], "]"}], " ", 
             RowBox[{"g", "[", "2", "]"}], " ", 
             RowBox[{"ng", "[", 
              RowBox[{"2", ",", "0"}], "]"}]}], 
            RowBox[{"g", "[", "0", "]"}]]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"n", "[", "1", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{
             SuperscriptBox["\[ExponentialE]", 
              RowBox[{"-", 
               FractionBox[
                RowBox[{"en", "[", 
                 RowBox[{"2", ",", "1"}], "]"}], 
                RowBox[{"KB", " ", "Tkin"}]]}]], " ", "nc", " ", 
             RowBox[{"g", "[", "2", "]"}], " ", 
             RowBox[{"k", "[", 
              RowBox[{"2", ",", "1"}], "]"}]}], 
            RowBox[{"g", "[", "1", "]"}]], "+", 
           FractionBox[
            RowBox[{
             RowBox[{"A", "[", 
              RowBox[{"2", ",", "1"}], "]"}], " ", 
             RowBox[{"g", "[", "2", "]"}], " ", 
             RowBox[{"ng", "[", 
              RowBox[{"2", ",", "1"}], "]"}]}], 
            RowBox[{"g", "[", "1", "]"}]]}], ")"}]}], "+", 
        RowBox[{
         RowBox[{"n", "[", "2", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "nc"}], " ", 
            RowBox[{"k", "[", 
             RowBox[{"2", ",", "0"}], "]"}]}], "-", 
           RowBox[{"nc", " ", 
            RowBox[{"k", "[", 
             RowBox[{"2", ",", "1"}], "]"}]}], "-", 
           RowBox[{
            RowBox[{"A", "[", 
             RowBox[{"2", ",", "0"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"ng", "[", 
               RowBox[{"2", ",", "0"}], "]"}]}], ")"}]}], "-", 
           RowBox[{
            RowBox[{"A", "[", 
             RowBox[{"2", ",", "1"}], "]"}], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"ng", "[", 
               RowBox[{"2", ",", "1"}], "]"}]}], ")"}]}]}], ")"}]}]}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.564103894621984*^9, 3.564103930232046*^9, {3.564104555831513*^9, 
   3.564104598594522*^9}, 3.564104647426385*^9, 3.5641046877449617`*^9, {
   3.564104782549036*^9, 3.564104827162631*^9}, 3.564153233309395*^9, 
   3.5641575605653687`*^9, 3.564157805806521*^9, {3.564159781601679*^9, 
   3.564159842405517*^9}, {3.564160236359441*^9, 3.5641602531609507`*^9}, 
   3.564160473746244*^9, {3.56416056787719*^9, 3.564160589260504*^9}, 
   3.5641606457018948`*^9, 3.564160912072307*^9, 3.5641609623912067`*^9, 
   3.5641613186155357`*^9, 3.564161554184716*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.564103894621984*^9, 3.564103930232046*^9, {3.564104555831513*^9, 
   3.564104598594522*^9}, 3.564104647426385*^9, 3.5641046877449617`*^9, {
   3.564104782549036*^9, 3.564104827162631*^9}, 3.564153233309395*^9, 
   3.5641575605653687`*^9, 3.564157805806521*^9, {3.564159781601679*^9, 
   3.564159842405517*^9}, {3.564160236359441*^9, 3.5641602531609507`*^9}, 
   3.564160473746244*^9, {3.56416056787719*^9, 3.564160589260504*^9}, 
   3.5641606457018948`*^9, 3.564160912072307*^9, 3.5641609623912067`*^9, 
   3.5641613186155357`*^9, 3.564161554207165*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.564103894621984*^9, 3.564103930232046*^9, {3.564104555831513*^9, 
   3.564104598594522*^9}, 3.564104647426385*^9, 3.5641046877449617`*^9, {
   3.564104782549036*^9, 3.564104827162631*^9}, 3.564153233309395*^9, 
   3.5641575605653687`*^9, 3.564157805806521*^9, {3.564159781601679*^9, 
   3.564159842405517*^9}, {3.564160236359441*^9, 3.5641602531609507`*^9}, 
   3.564160473746244*^9, {3.56416056787719*^9, 3.564160589260504*^9}, 
   3.5641606457018948`*^9, 3.564160912072307*^9, 3.5641609623912067`*^9, 
   3.5641613186155357`*^9, 3.564161554208864*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"n", "[", "0", "]"}], "\[Rule]", "0.16381137460469927`"}], ",", 
    RowBox[{
     RowBox[{"n", "[", "1", "]"}], "\[Rule]", "0.3532498251095242`"}], ",", 
    RowBox[{
     RowBox[{"n", "[", "2", "]"}], "\[Rule]", "0.4829388002857765`"}]}], 
   "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.564103894621984*^9, 3.564103930232046*^9, {3.564104555831513*^9, 
   3.564104598594522*^9}, 3.564104647426385*^9, 3.5641046877449617`*^9, {
   3.564104782549036*^9, 3.564104827162631*^9}, 3.564153233309395*^9, 
   3.5641575605653687`*^9, 3.564157805806521*^9, {3.564159781601679*^9, 
   3.564159842405517*^9}, {3.564160236359441*^9, 3.5641602531609507`*^9}, 
   3.564160473746244*^9, {3.56416056787719*^9, 3.564160589260504*^9}, 
   3.5641606457018948`*^9, 3.564160912072307*^9, 3.5641609623912067`*^9, 
   3.5641613186155357`*^9, 3.5641615547204237`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"the sum of the population densities = \"\>", 
   "\[InvisibleSpace]", "1.`"}],
  SequenceForm["the sum of the population densities = ", 1.],
  Editable->False]], "Print",
 CellChangeTimes->{3.5641606457672977`*^9, 3.564160913047536*^9, 
  3.564160962523026*^9, 3.5641613186578627`*^9, 3.564161554783087*^9}]
}, Open  ]]
},
WindowSize->{1440, 880},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>FEPrivate`If[
  FEPrivate`Equal[FEPrivate`$VersionNumber, 6.], 1.25, 1.25 Inherited],
FrontEndVersion->"8.0 for Linux x86 (64-bit) (November 7, 2010)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 16646, 450, 1891, "Input"],
Cell[17228, 474, 1317, 32, 87, "Output"],
Cell[18548, 508, 2572, 69, 141, "Output"],
Cell[21123, 579, 1836, 48, 91, "Output"],
Cell[22962, 629, 1972, 51, 111, "Output"],
Cell[24937, 682, 4363, 123, 143, "Output"],
Cell[29303, 807, 4342, 120, 143, "Output"],
Cell[33648, 929, 7593, 219, 168, "Output"],
Cell[41244, 1150, 9344, 251, 195, "Output"],
Cell[50591, 1403, 606, 9, 37, "Output"],
Cell[51200, 1414, 606, 9, 37, "Output"],
Cell[51809, 1425, 932, 19, 37, "Output"],
Cell[52744, 1446, 356, 7, 29, "Print"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
